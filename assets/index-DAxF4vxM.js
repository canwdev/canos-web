import{d as e,o as a,c as t,b as l,_ as n,n as i,h as s,bQ as o,D as r,$ as c,bP as u,bZ as d,bM as p,z as m,N as v,E as h,G as y,a8 as f,f as w,J as g,F as b,e as k,k as x,j as C,aY as _,M as L,bt as I,bk as A,bl as S,bn as P,r as T,w as M,a as D,Y as E,bm as R,bI as B,T as N,b_ as z,bN as $,b$ as K,c0 as V,ax as F,bi as j,v as O,g as Y,bY as H}from"./index-DSBX7T2Q.js";import{n as U,f as q}from"./index-N0BWoT0i.js";import{_ as G}from"./Slider-qMkOxw2w.js";const W={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},J=[l("g",{fill:"none"},[l("path",{d:"M16.5 6.671c.116 0 .223.04.308.107l.067.063l.017.02a5 5 0 0 1-3.675 8.135L13 15H7a5.07 5.07 0 0 1-.303-.009l1.657 1.655a.5.5 0 0 1 .057.638l-.057.07a.5.5 0 0 1-.638.057l-.07-.057l-2.5-2.5a.5.5 0 0 1-.057-.638l.057-.07l2.5-2.5a.5.5 0 0 1 .765.638l-.057.07l-1.637 1.636l.14.008L7 14h6a4 4 0 0 0 3.11-6.516a.5.5 0 0 1 .39-.812zm-4.854-4.025a.5.5 0 0 1 .638-.057l.07.057l2.5 2.5l.057.07a.5.5 0 0 1 0 .568l-.057.07l-2.5 2.5l-.07.057a.5.5 0 0 1-.568 0l-.07-.057l-.057-.07a.5.5 0 0 1 0-.568l.057-.07l1.637-1.636l-.14-.008L13 6H7a4 4 0 0 0-3.105 6.522a.5.5 0 1 1-.801.601a5 5 0 0 1 3.689-8.119L7 5h6c.102 0 .203.003.303.009l-1.657-1.655l-.057-.07a.5.5 0 0 1 .057-.638z",fill:"currentColor"})],-1)],Q=e({name:"ArrowRepeatAll20Regular",render:function(e,l){return a(),t("svg",W,J)}}),X={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Z=[l("g",{fill:"none"},[l("path",{d:"M15.987 3.016a1 1 0 0 0-1.285-.79l-7 2.187A1 1 0 0 0 7 5.368V13.5a2.5 2.5 0 1 0 1 2V8.368l7-2.188v5.32a2.5 2.5 0 1 0 1 2V3.18c0-.056-.005-.11-.013-.164z",fill:"currentColor"})],-1)],ee=e({name:"MusicNote220Filled",render:function(e,l){return a(),t("svg",X,Z)}}),ae={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},te=[l("g",{fill:"none"},[l("path",{d:"M3 4.252c0-1 1.116-1.595 1.947-1.038l8.499 5.707a1.25 1.25 0 0 1 .007 2.071l-8.5 5.793A1.25 1.25 0 0 1 3 15.752v-11.5zM17 3.5a.5.5 0 0 0-1 0v13a.5.5 0 1 0 1 0v-13z",fill:"currentColor"})],-1)],le=e({name:"Next20Filled",render:function(e,l){return a(),t("svg",ae,te)}}),ne={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},ie=[l("g",{fill:"none"},[l("path",{d:"M12 3.5A1.5 1.5 0 0 1 13.5 2h2A1.5 1.5 0 0 1 17 3.5v13a1.5 1.5 0 0 1-1.5 1.5h-2a1.5 1.5 0 0 1-1.5-1.5v-13zm-9 0A1.5 1.5 0 0 1 4.5 2h2A1.5 1.5 0 0 1 8 3.5v13A1.5 1.5 0 0 1 6.5 18h-2A1.5 1.5 0 0 1 3 16.5v-13z",fill:"currentColor"})],-1)],se=e({name:"Pause20Filled",render:function(e,l){return a(),t("svg",ne,ie)}}),oe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},re=[l("g",{fill:"none"},[l("path",{d:"M9 7.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5zm3 0a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5zM10 2a8 8 0 1 0 0 16a8 8 0 0 0 0-16zm-7 8a7 7 0 1 1 14 0a7 7 0 0 1-14 0z",fill:"currentColor"})],-1)],ce=e({name:"PauseCircle20Regular",render:function(e,l){return a(),t("svg",oe,re)}}),ue={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},de=[l("g",{fill:"none"},[l("path",{d:"M17.222 8.685a1.5 1.5 0 0 1 0 2.628l-10 5.498A1.5 1.5 0 0 1 5 15.496V4.502a1.5 1.5 0 0 1 2.223-1.314l10 5.497z",fill:"currentColor"})],-1)],pe=e({name:"Play20Filled",render:function(e,l){return a(),t("svg",ue,de)}}),me={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},ve=[l("g",{fill:"none"},[l("path",{d:"M9.125 7.184A.75.75 0 0 0 8 7.834v4.333a.75.75 0 0 0 1.125.65l4.125-2.384a.5.5 0 0 0 0-.866L9.125 7.184zM2 10a8 8 0 1 1 16 0a8 8 0 0 1-16 0zm8-7a7 7 0 1 0 0 14a7 7 0 0 0 0-14z",fill:"currentColor"})],-1)],he=e({name:"PlayCircle20Regular",render:function(e,l){return a(),t("svg",me,ve)}}),ye={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},fe=[l("g",{fill:"none"},[l("path",{d:"M17 4.252c0-1-1.116-1.595-1.947-1.038L6.554 8.921a1.25 1.25 0 0 0-.007 2.071l8.5 5.793A1.25 1.25 0 0 0 17 15.752v-11.5zM3 3.5a.5.5 0 0 1 1 0v13a.5.5 0 0 1-1 0v-13z",fill:"currentColor"})],-1)],we=e({name:"Previous20Filled",render:function(e,l){return a(),t("svg",ye,fe)}}),ge={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},be=[l("g",{fill:"none"},[l("path",{d:"M12 3.006c0-.873-1.04-1.327-1.68-.733L6.448 5.866a.5.5 0 0 1-.34.134H3.5A1.5 1.5 0 0 0 2 7.5v5A1.5 1.5 0 0 0 3.5 14h2.607a.5.5 0 0 1 .34.133l3.873 3.594c.64.593 1.68.14 1.68-.733V3.006zm3.254 1.621a.5.5 0 0 1 .706.04a8 8 0 0 1 0 10.666a.5.5 0 1 1-.745-.667a7 7 0 0 0 0-9.333a.5.5 0 0 1 .039-.706zm-1.175 8.306a.5.5 0 0 1-.184-.683a4.498 4.498 0 0 0 0-4.5a.5.5 0 1 1 .865-.5a5.498 5.498 0 0 1 .001 5.5a.5.5 0 0 1-.682.183z",fill:"currentColor"})],-1)],ke=e({name:"Speaker220Filled",render:function(e,l){return a(),t("svg",ge,be)}}),xe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Ce=[l("g",{fill:"none"},[l("path",{d:"M2.854 2.146a.5.5 0 1 0-.708.708L5.293 6H3.497a1.5 1.5 0 0 0-1.5 1.5v5a1.5 1.5 0 0 0 1.5 1.5h2.608a.5.5 0 0 1 .34.133l3.872 3.594c.64.594 1.68.14 1.68-.733v-4.29l5.15 5.15a.5.5 0 0 0 .707-.708l-2.563-2.562L2.854 2.146zm8.143 9.558v5.29L7.125 13.4a1.5 1.5 0 0 0-1.02-.4H3.497a.5.5 0 0 1-.5-.5v-5a.5.5 0 0 1 .5-.5h2.608c.06 0 .119-.004.177-.01l4.715 4.714zm0-8.698v5.87l1 1v-6.87c0-.873-1.04-1.327-1.68-.733l-3.072 2.85l.708.708l3.044-2.825zm3.064 8.934l.742.741a5.497 5.497 0 0 0-.04-5.431a.5.5 0 0 0-.866.5c.77 1.333.78 2.896.164 4.19zm1.835 1.835l.722.722a8.004 8.004 0 0 0-.655-9.83a.5.5 0 1 0-.745.667a7.004 7.004 0 0 1 .678 8.441z",fill:"currentColor"})],-1)],_e=e({name:"SpeakerOff20Regular",render:function(e,l){return a(),t("svg",xe,Ce)}}),Le={name:"CoverDisplay",props:{src:{type:String,default:null},isRounded:{type:Boolean,default:!1},isRotating:{type:Boolean,default:!1},isShowIcon:{type:Boolean,default:!0}}},Ie={class:"cover-display"},Ae=["src"],Se={key:1,class:"cover-icon"};const Pe=n(Le,[["render",function(e,l,n,o,r,c){return a(),t("div",Ie,[n.src?(a(),t("img",{key:0,src:n.src,class:i({rounded:n.isRounded,rotating:n.isRotating})},null,10,Ae)):n.isShowIcon?(a(),t("span",Se,"CC")):s("",!0)])}],["__scopeId","data-v-00511d1e"]]),Te=o(),Me=Te,De="ACTION_PLAY",Ee="ACTION_PAUSE",Re="ACTION_TOGGLE_PLAY",Be="ACTION_CHANGE_CURRENT_TIME",Ne=(e,a)=>{r((()=>{Te.on(e,a)})),c((()=>{Te.off(e,a)}))};class ze{constructor(e,a){this.guid=p(),this.filename=e,this.basePath=a}get absPath(){return U(this.basePath+"/"+this.filename)}get titleDisplay(){return this.filename}}const $e=[1,2,3,4,5],Ke={1:{value:1,i18nKey:"msg.play-in-order"},5:{value:5,i18nKey:"shuffle"},2:{value:2,icon:Q,i18nKey:"msg.sequential-loop"},3:{value:3,icon:Q,className:"reverse-x",i18nKey:"msg.reverse-loop"},4:{value:4,i18nKey:"msg.single-cycle"}},Ve=u("music",{state:()=>({musicItem:null,playingList:[],playingIndex:0,paused:!0,currentTime:0,duration:0,playbackRate:1,stopCountdown:null,isPlayEnded:!1,isLoadedAutoplay:!0}),actions:{playFromList(e=[],a=0){const t=e[a];t?(this.playingList=e,this.playingIndex=a,this.musicItem=t,this.isLoadedAutoplay=!0):window.$message.error(`index=${a} not found`)},playPrev(){let e=this.playingIndex-1;e<0&&(e=this.playingList.length-1),this.playByIndex(e)},playShuffle(){this.playByIndex(function(e,a){const t=e.reduce(((e,t,l)=>(l!==a&&e.push(l),e)),[]);return t[d(0,t.length-1)]}(this.playingList,this.playingIndex))},playNext(){const e=Fe();if(5===e.loopMode)return void this.playShuffle();let a=this.playingIndex+1;if(a>this.playingList.length-1){if(2!==e.loopMode)return;a=0}this.playByIndex(a)},handlePlayEnded(){const e=Fe();this.isPlayEnded=!0,4!==e.loopMode?3!==e.loopMode?5!==e.loopMode?this.playNext():this.playShuffle():this.playPrev():Me.emit(De)},playByIndex(e){this.musicItem=this.playingList[e],this.playingIndex=e,console.log("[playByIndex]",e,this.musicItem),setTimeout((()=>{this.isPlayEnded?(Me.emit(De),this.isPlayEnded=!1):this.paused&&Me.emit(De)}),100)}}}),Fe=u("musicSettings",{state:()=>({loopMode:2,audioVolume:100}),actions:{setAudioVolume(e){(e=Number(e))>100&&(e=100),e<0&&(e=0),this.audioVolume=e},volumeUp(e=5){const a=this.audioVolume+e;this.setAudioVolume(a)},volumeDown(e=5){const a=this.audioVolume-e;this.setAudioVolume(a)}},persist:{key:"ls_key_canos_music_settings"}}),je={LYRIC:"LYRIC",METADATA:"METADATA"},Oe=e({name:"MusicDetail",components:{CoverDisplay:Pe},data(){return{currentDetailTab:je.LYRIC,DetailTabEnum:je,detailTabList:[{label:this.$t("lyric"),value:je.LYRIC},{label:this.$t("metadata"),value:je.METADATA}],isShowDetail:!1,isShowLyricSearch:!1,isLyricLock:!1,lyricObj:null,isShowPlaybackRate:!1,isShowCountdownConfig:!1}},setup(){const e=Ve();return{musicStore:e,musicItem:m((()=>e.musicItem)),jumpForward(){Me.emit(Be,e.currentTime+=5)},jumpBackward(){Me.emit(Be,e.currentTime-=5)},handlePlaybackRateChange(a){e.playbackRate=Number(a)}}}}),Ye=e=>(A("data-v-ca096697"),e=e(),S(),e),He={key:0,class:"music-detail"},Ue={class:"cover-wrap"},qe={class:"detail-content bg-dark"},Ge={class:"tab-wrap"},We=["onClick"],Je={class:"lyric-content"},Qe={class:"lyric-lock"},Xe=["title"],Ze=[Ye((()=>l("i",{class:"material-icons"},"search",-1)))],ea=["title"],aa={class:"material-icons"},ta=["value","placeholder"],la={class:"below-wrap"},na={class:"title"},ia={class:"subtitle"},sa={class:"subtitle"},oa={class:"actions-wrap"},ra=[Ye((()=>l("i",{class:"material-icons"},"replay_5",-1)))],ca=["title"],ua=[Ye((()=>l("i",{class:"material-icons"},"speed",-1)))],da=[Ye((()=>l("i",{class:"material-icons"},"forward_5",-1)))];const pa=n(Oe,[["render",function(e,n,o,r,c,u){const d=v("CoverDisplay"),p=v("AutoRatioBox"),m=_,A=G,S=L,P=I;return e.musicItem?(a(),t("div",He,[h(p,{class:"cover-wrap-box"},{default:y((()=>[l("div",Ue,[h(d,{class:"big-cover",src:e.musicItem.cover,"is-rotating":!1,"is-rounded":!1,"is-show-icon":!1,onClick:n[0]||(n[0]=a=>e.isShowDetail=!0)},null,8,["src"]),h(f,{name:"fade"},{default:y((()=>[w(l("div",qe,[l("div",Ge,[(a(!0),t(b,null,k(e.detailTabList,(l=>(a(),t("button",{key:l.value,class:i([{active:e.currentDetailTab===l.value},"btn-no-style"]),onClick:a=>e.currentDetailTab=l.value},x(l.label),11,We)))),128))]),w(l("div",Je,[l("div",Qe,[l("button",{class:"btn-no-style",title:e.$t("search-lyric"),onClick:n[1]||(n[1]=a=>e.isShowLyricSearch=!0)},Ze,8,Xe),l("button",{class:"btn-no-style",title:e.$t("lock-lyric"),onClick:n[2]||(n[2]=a=>e.isLyricLock=!e.isLyricLock)},[l("i",aa,x(e.isLyricLock?"lock":"lock_open"),1)],8,ea)]),l("div",{class:"lrc-main no-lyric",onClick:n[3]||(n[3]=a=>e.isShowDetail=!1)},x(e.$t("msg.no-lyric"))+" TBD ",1)],512),[[g,e.currentDetailTab===e.DetailTabEnum.LYRIC]]),w(l("textarea",{class:"metadata",cols:"30",rows:"15",readonly:"",value:JSON.stringify(e.musicItem,null,2),placeholder:e.$t("msg.no-data")},null,8,ta),[[g,e.currentDetailTab===e.DetailTabEnum.METADATA]])],512),[[g,e.isShowDetail]])])),_:1})])])),_:1}),l("div",la,[l("div",{class:i(["titles-wrap",{opacity:e.isShowDetail}]),onClick:n[4]||(n[4]=a=>e.isShowDetail=!e.isShowDetail)},[l("div",na,x(e.musicItem.titleDisplay),1),l("div",ia,x(e.musicItem.artisDisplay),1),l("div",sa,x(e.musicItem.album),1)],2),l("div",oa,[l("button",{class:"btn-no-style",onClick:n[5]||(n[5]=(...a)=>e.jumpBackward&&e.jumpBackward(...a))},ra),l("button",{class:"btn-no-style",title:e.$t("playback-speed"),onClick:n[6]||(n[6]=a=>e.isShowPlaybackRate=!0)},ua,8,ca),l("button",{class:"btn-no-style",onClick:n[7]||(n[7]=(...a)=>e.jumpForward&&e.jumpForward(...a))},da)])]),h(P,{show:e.isShowPlaybackRate,"onUpdate:show":n[11]||(n[11]=a=>e.isShowPlaybackRate=a),preset:"dialog","show-icon":!1,title:e.$t("playback-speed")},{default:y((()=>[h(S,{align:"center"},{default:y((()=>[h(m,{onClick:n[8]||(n[8]=a=>e.handlePlaybackRateChange(1))},{default:y((()=>[C("重置")])),_:1}),h(A,{style:{width:"200px"},value:e.musicStore.playbackRate,"onUpdate:value":[n[9]||(n[9]=a=>e.musicStore.playbackRate=a),n[10]||(n[10]=a=>e.handlePlaybackRateChange(e.musicStore.playbackRate))],step:"marks",max:2,min:.2,marks:{.2:"0.2",.5:"0.5",1:"1",1.2:"1.2",1.5:"1.5",2:"2"}},null,8,["value"])])),_:1})])),_:1},8,["show","title"]),h(P,{show:e.isShowLyricSearch,"onUpdate:show":n[12]||(n[12]=a=>e.isShowLyricSearch=a),preset:"dialog","show-icon":!1,title:"Search Lyric"},{default:y((()=>[C("TBD ")])),_:1},8,["show"])])):s("",!0)}],["__scopeId","data-v-ca096697"]]),ma={class:"player-core"},va=["src"],ha=e({__name:"PlayerCore",setup(e){const n=Ve(),{t:i}=P(),s=T(),o=Fe(),u=T(),d=()=>{s.value.play()},p=()=>{s.value.pause()},m=()=>{n.playPrev()},v=()=>{n.playNext()},h=e=>{s.value&&(s.value.volume=e/100)},y=(e=1)=>{if(s.value)try{s.value.playbackRate=e}catch(a){window.$message.error(a.message)}};return M((()=>o.audioVolume),h),M((()=>n.playbackRate),y),M((()=>n.musicItem),(async e=>{e||(u.value=void 0);const{key:a}=await q.createShareLink({paths:[e.absPath]});u.value=q.getStreamShareLink(a)}),{immediate:!0}),r((()=>{var e;e=s.value,"mediaSession"in navigator&&(navigator.mediaSession.setActionHandler("play",d),navigator.mediaSession.setActionHandler("pause",p),navigator.mediaSession.setActionHandler("previoustrack",m),navigator.mediaSession.setActionHandler("nexttrack",v)),e.addEventListener("play",(()=>{n.paused=!1,n.isLoadedAutoplay=!0})),e.addEventListener("pause",(()=>{n.paused=!0,n.isLoadedAutoplay=!1})),e.addEventListener("ended",(()=>{n.handlePlayEnded()})),e.addEventListener("canplay",(e=>{n.duration=e.target.duration,n.isLoadedAutoplay&&d()})),e.addEventListener("timeupdate",(e=>{n.currentTime=e.target.currentTime})),e.addEventListener("error",(e=>{console.error(e),window.$message.error(i("msg.load-fail-or-no-supported-source"))})),h(o.audioVolume),y(n.playbackRate)})),Ne(Re,(()=>{s.value&&s.value.src&&(s.value.paused?d():p())})),Ne(De,d),Ne(Ee,p),Ne(Be,(e=>{s.value&&(s.value.currentTime=e)})),c((()=>{})),(e,n)=>(a(),t("div",ma,[l("audio",{ref_key:"audioRef",ref:s,src:D(u),controls:""},null,8,va)]))}}),ya={class:"btn-no-style btn-cover flex items-center justify-center"},fa={key:1,class:"icon-wrap"},wa=n(e({__name:"CoverMini",props:{src:{}},setup:e=>(e,l)=>(a(),t("button",ya,[E(e.$slots,"default",{},void 0,!0),e.src?(a(),R(Pe,{key:0,src:e.src},null,8,["src"])):(a(),t("i",fa,[h(D(ee))]))]))}),[["__scopeId","data-v-fa899b89"]]),ga={name:"TkSeekbar",props:{min:{type:[Number,String],default:0},max:{type:[Number,String],default:100},value:{type:[Number,String],default:100},vertical:{type:Boolean,default:!1},wheel:{type:Boolean,default:!1}},emits:["input","focus","blur","change"],computed:{progress(){return(this.value/this.max*100).toFixed(1)}},methods:{handleInput(e){this.$emit("input",e.target.value)},handleFocus(e){this.$emit("focus",e)},handleBlur(e){this.$emit("blur",e)},handleChange(e){this.$emit("change",e.target.value)},handleWheel(e){if(this.wheel){e.preventDefault();const a=this.$refs.seekBar,t=e.deltaY||0,l=Math.abs(t)/64;t>0?a.value=this.value-l:t<0&&(a.value=this.value+l),this.$emit("input",a.value)}}}},ba=["min","max","value"];const ka=n(ga,[["render",function(e,n,o,r,c,u){return a(),t("div",{class:i(["tk-seekbar",{vertical:o.vertical}])},[o.vertical?s("",!0):(a(),t("div",{key:0,class:"seekbar-fill",style:B("width:"+u.progress+"%")},null,4)),l("input",N({ref:"seekBar",type:"range",min:o.min,max:o.max,value:o.value,class:"common-seekbar seekbar-input"},e.$attrs,{onInput:n[0]||(n[0]=(...e)=>u.handleInput&&u.handleInput(...e)),onFocus:n[1]||(n[1]=(...e)=>u.handleFocus&&u.handleFocus(...e)),onBlur:n[2]||(n[2]=(...e)=>u.handleBlur&&u.handleBlur(...e)),onChange:n[3]||(n[3]=(...e)=>u.handleChange&&u.handleChange(...e)),onWheel:n[4]||(n[4]=(...e)=>u.handleWheel&&u.handleWheel(...e))}),null,16,ba)],2)}],["__scopeId","data-v-fc3749d0"]]);var xa,Ca={exports:{}};xa=Ca,function(e,a,t){if(e){for(var l,n={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},i={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},o={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},r=1;r<20;++r)n[111+r]="f"+r;for(r=0;r<=9;++r)n[r+96]=r.toString();h.prototype.bind=function(e,a,t){var l=this;return e=e instanceof Array?e:[e],l._bindMultiple.call(l,e,a,t),l},h.prototype.unbind=function(e,a){return this.bind.call(this,e,(function(){}),a)},h.prototype.trigger=function(e,a){var t=this;return t._directMap[e+":"+a]&&t._directMap[e+":"+a]({},e),t},h.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},h.prototype.stopCallback=function(e,a){if((" "+a.className+" ").indexOf(" mousetrap ")>-1)return!1;if(v(a,this.target))return!1;if("composedPath"in e&&"function"==typeof e.composedPath){var t=e.composedPath()[0];t!==e.target&&(a=t)}return"INPUT"==a.tagName||"SELECT"==a.tagName||"TEXTAREA"==a.tagName||a.isContentEditable},h.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},h.addKeycodes=function(e){for(var a in e)e.hasOwnProperty(a)&&(n[a]=e[a]);l=null},h.init=function(){var e=h(a);for(var t in e)"_"!==t.charAt(0)&&(h[t]=function(a){return function(){return e[a].apply(e,arguments)}}(t))},h.init(),e.Mousetrap=h,xa.exports&&(xa.exports=h)}function c(e,a,t){e.addEventListener?e.addEventListener(a,t,!1):e.attachEvent("on"+a,t)}function u(e){if("keypress"==e.type){var a=String.fromCharCode(e.which);return e.shiftKey||(a=a.toLowerCase()),a}return n[e.which]?n[e.which]:i[e.which]?i[e.which]:String.fromCharCode(e.which).toLowerCase()}function d(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function p(e,a,t){return t||(t=function(){if(!l)for(var e in l={},n)e>95&&e<112||n.hasOwnProperty(e)&&(l[n[e]]=e);return l}()[e]?"keydown":"keypress"),"keypress"==t&&a.length&&(t="keydown"),t}function m(e,a){var t,l,n,i=[];for(t=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),n=0;n<t.length;++n)l=t[n],o[l]&&(l=o[l]),a&&"keypress"!=a&&s[l]&&(l=s[l],i.push("shift")),d(l)&&i.push(l);return{key:l,modifiers:i,action:a=p(l,i,a)}}function v(e,t){return null!==e&&e!==a&&(e===t||v(e.parentNode,t))}function h(e){var t=this;if(e=e||a,!(t instanceof h))return new h(e);t.target=e,t._callbacks={},t._directMap={};var l,n={},i=!1,s=!1,o=!1;function r(e){e=e||{};var a,t=!1;for(a in n)e[a]?t=!0:n[a]=0;t||(o=!1)}function p(e,a,l,i,s,o){var r,c,u,p,m=[],v=l.type;if(!t._callbacks[e])return[];for("keyup"==v&&d(e)&&(a=[e]),r=0;r<t._callbacks[e].length;++r)if(c=t._callbacks[e][r],(i||!c.seq||n[c.seq]==c.level)&&v==c.action&&("keypress"==v&&!l.metaKey&&!l.ctrlKey||(u=a,p=c.modifiers,u.sort().join(",")===p.sort().join(",")))){var h=!i&&c.combo==s,y=i&&c.seq==i&&c.level==o;(h||y)&&t._callbacks[e].splice(r,1),m.push(c)}return m}function v(e,a,l,n){t.stopCallback(a,a.target||a.srcElement,l,n)||!1===e(a,l)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(a),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(a))}function y(e){"number"!=typeof e.which&&(e.which=e.keyCode);var a=u(e);a&&("keyup"!=e.type||i!==a?t.handleKey(a,function(e){var a=[];return e.shiftKey&&a.push("shift"),e.altKey&&a.push("alt"),e.ctrlKey&&a.push("ctrl"),e.metaKey&&a.push("meta"),a}(e),e):i=!1)}function f(e,a,t,s){function c(a){return function(){o=a,++n[e],clearTimeout(l),l=setTimeout(r,1e3)}}function d(a){v(t,a,e),"keyup"!==s&&(i=u(a)),setTimeout(r,10)}n[e]=0;for(var p=0;p<a.length;++p){var h=p+1===a.length?d:c(s||m(a[p+1]).action);w(a[p],h,s,e,p)}}function w(e,a,l,n,i){t._directMap[e+":"+l]=a;var s,o=(e=e.replace(/\s+/g," ")).split(" ");o.length>1?f(e,o,a,l):(s=m(e,l),t._callbacks[s.key]=t._callbacks[s.key]||[],p(s.key,s.modifiers,{type:s.action},n,e,i),t._callbacks[s.key][n?"unshift":"push"]({callback:a,modifiers:s.modifiers,action:s.action,seq:n,level:i,combo:e}))}t._handleKey=function(e,a,t){var l,n=p(e,a,t),i={},c=0,u=!1;for(l=0;l<n.length;++l)n[l].seq&&(c=Math.max(c,n[l].level));for(l=0;l<n.length;++l)if(n[l].seq){if(n[l].level!=c)continue;u=!0,i[n[l].seq]=1,v(n[l].callback,t,n[l].combo,n[l].seq)}else u||v(n[l].callback,t,n[l].combo);var m="keypress"==t.type&&s;t.type!=o||d(e)||m||r(i),s=u&&"keydown"==t.type},t._bindMultiple=function(e,a,t){for(var l=0;l<e.length;++l)w(e[l],a,t)},c(e,"keypress",y),c(e,"keydown",y),c(e,"keyup",y)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null);const _a=z(Ca.exports),La={key:0,class:"actionbar-wrapper"},Ia={class:"progressbar"},Aa={class:"time text-overflow"},Sa={class:"time text-overflow"},Pa={class:"actionbar"},Ta={class:"title text-overflow"},Ma={class:"buttons-scroll"},Da=["disabled","title"],Ea={class:"icon-wrap"},Ra=["disabled","title"],Ba={class:"icon-wrap _lg"},Na=["disabled","title"],za={class:"icon-wrap"},$a=["title"],Ka={key:1},Va=["title"],Fa={class:"icon-wrap"},ja={style:{display:"flex","align-items":"center","flex-direction":"column"}},Oa={style:{"font-size":"12px"}},Ya=n(e({__name:"MusicControl",emits:["onCoverClick","onTitleClick"],setup(e,{emit:n}){const o=Ve(),u=["left","pageup","k","l"],d=["right","pagedown","h","j"],{t:p}=P(),v=Fe(),f=T(0),b=T(!1),k=T(!1),C=$(),_=e=>{e.preventDefault(),Me.emit(Re)},L=()=>{o.playPrev()},I=()=>{o.playNext()},A=e=>{e.preventDefault(),v.volumeUp()},S=e=>{e.preventDefault(),v.volumeDown()},E=()=>{let e=$e.findIndex((e=>e===v.loopMode));++e,e>$e.length-1&&(e=0),$e[e]&&(v.loopMode=$e[e],window.$message.info(p(z.value.i18nKey)))},B=e=>{b.value=!0,f.value=Number(e)},N=e=>{e=Number(e),Me.emit(Be,e),b.value=!1},z=m((()=>Ke[v.loopMode]));r((()=>{const e=new _a;e.bind("space",_),e.bind(u,L),e.bind(d,I),e.bind("ctrl+x",E),e.bind("up",A),e.bind("down",S),C.value=e})),c((()=>{C.value&&C.value.reset()})),M((()=>o.currentTime),(e=>{b.value||(f.value=e)}));const j=m((()=>o.musicItem));return(e,n)=>{const r=G,c=F;return D(j)?(a(),t("div",La,[l("div",Ia,[l("span",Aa,x(D(K)(D(f))),1),h(ka,{max:D(o).duration,value:D(f),onInput:B,onChange:N},null,8,["max","value"]),l("span",Sa,x(D(K)(D(o).duration)),1)]),l("div",Pa,[h(wa,{src:D(j).cover,"icon-name":"audiotrack",onClick:n[0]||(n[0]=a=>e.$emit("onCoverClick"))},null,8,["src"]),l("button",{class:"btn-song-info btn-no-style",onClick:n[1]||(n[1]=a=>e.$emit("onTitleClick"))},[l("span",Ta,x(D(j).titleDisplay),1),w(l("span",{class:"artist text-overflow"},x(D(j).artist),513),[[g,D(j).artist]]),w(l("span",{class:"album text-overflow"},x(D(j).album),513),[[g,D(j).album]])]),l("div",Ma,[l("button",{disabled:D(k),class:"btn-action btn-no-style",title:D(p)("previous"),onClick:L},[l("i",Ea,[h(D(we))])],8,Da),l("button",{disabled:D(k),class:"btn-action btn-no-style",title:D(o).paused?D(p)("play"):D(p)("pause"),onClick:_},[l("i",Ba,[D(o).paused?(a(),R(D(he),{key:0})):(a(),R(D(ce),{key:1}))])],8,Ra),l("button",{disabled:D(k),class:"btn-action btn-no-style",title:D(p)("next"),onClick:I},[l("i",za,[h(D(le))])],8,Na),D(z)?(a(),t("button",{key:0,class:"btn-action btn-no-style",title:D(p)(D(z).i18nKey),onClick:E},[l("i",{class:i(["icon-wrap",D(z).className])},[D(z).icon?(a(),R(V(D(z).icon),{key:0})):(a(),t("span",Ka,x(D(p)(D(z).i18nKey)),1))],2)],8,$a)):s("",!0),h(c,{placement:"top",trigger:"click"},{trigger:y((()=>[l("button",{class:"btn-action btn-no-style",title:D(p)("volume")},[l("i",Fa,[D(v).audioVolume>0?(a(),R(D(ke),{key:0})):(a(),R(D(_e),{key:1}))])],8,Va)])),default:y((()=>[l("div",ja,[h(r,{vertical:"",style:{height:"100px"},max:100,tooltip:!1,value:D(v).audioVolume,"onUpdate:value":n[2]||(n[2]=e=>D(v).audioVolume=e)},null,8,["value"]),l("span",Oa,x(D(v).audioVolume),1)])])),_:1})])])])):s("",!0)}}}),[["__scopeId","data-v-cfe94052"]]),Ha={class:"playlist-item"},Ua={class:"item-left"},qa={key:0,class:"status-icon"},Ga={class:"item-main"},Wa={class:"item-title"},Ja={class:"item-subtitle"},Qa=(e=>(A("data-v-f2882324"),e=e(),S(),e))((()=>l("div",{class:"item-right"},null,-1))),Xa=n(e({__name:"PlaylistItem",props:{item:{}},setup(e){const n=e,i=Ve(),{item:o}=j(n),r=m((()=>{var e;return o.value.guid===(null==(e=i.musicItem)?void 0:e.guid)}));return(e,n)=>(a(),t("div",Ha,[l("div",Ua,[D(r)?(a(),t("div",qa,[D(i).paused?(a(),R(D(se),{key:1})):(a(),R(D(pe),{key:0}))])):s("",!0),h(wa,{src:D(o).cover,"force-show-icon":""},null,8,["src"])]),l("div",Ga,[l("div",Wa,x(D(o).titleDisplay),1),l("div",Ja,x(D(o).artistsAlbumDisplay),1)]),Qa]))}}),[["__scopeId","data-v-f2882324"]]),Za={class:"music-play-list"},et={class:"vp-bg playlist-action-bar"},at=["placeholder"],tt={class:"music-list"},lt=n(e({__name:"index",setup(e){const n=Ve(),i=T(""),s=m((()=>{if(!i.value)return n.playingList;const e=new RegExp(i.value,"ig");return n.playingList.filter((a=>(a.titleDisplay,e.test(a.titleDisplay)||e.test(a.artistsAlbumDisplay))))}));return(e,o)=>(a(),t("div",Za,[l("div",et,[w(l("input",{class:"vp-input",placeholder:e.$t("filter-by-name"),"onUpdate:modelValue":o[0]||(o[0]=e=>Y(i)?i.value=e:null)},null,8,at),[[O,D(i)]]),l("span",null,x(D(n).playingIndex+1)+" / "+x(D(n).playingList.length),1)]),l("div",tt,[(a(!0),t(b,null,k(D(s),(e=>(a(),R(Xa,{key:e.guid,item:e,onClick:a=>(e=>{const a=n.playingList.findIndex((a=>a.guid===e.guid));-1!==a?a!==n.playingIndex?n.playByIndex(a):Me.emit(Re):console.error("idx not found!")})(e)},null,8,["item","onClick"])))),128))])]))}}),[["__scopeId","data-v-c14b70ec"]]),nt={class:"music-player-wrap"},it={class:"music-above"},st={class:"music-below"},ot=n(e({__name:"index",props:{appParams:{}},setup(e){const n=e,i=Ve();M((()=>n.appParams),(()=>{if(console.log(n.appParams),!n.appParams)return;const{item:e,list:a,basePath:t}=n.appParams,l=a.map((e=>new ze(e.name,t))).filter((e=>H(e.filename))),s=l.findIndex((a=>a.filename===e.name));i.playFromList(l,s)}),{immediate:!0});const s=T(!0);return(e,n)=>(a(),t("div",nt,[l("div",it,[w(h(lt,null,null,512),[[g,D(s)]]),w(h(pa,null,null,512),[[g,!D(s)]])]),l("div",st,[h(Ya,{onOnCoverClick:n[0]||(n[0]=e=>s.value=!D(s)),onOnTitleClick:n[1]||(n[1]=e=>s.value=!D(s))}),w(h(ha,null,null,512),[[g,!1]])])]))}}),[["__scopeId","data-v-011aa6cc"]]);export{ot as default};
