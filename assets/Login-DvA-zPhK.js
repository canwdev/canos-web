import{l as t,m as e,p as n,d as a,q as i,s as r,x as s,y as l,z as o,A as d,B as c,F as h,C as p,r as u,w as g,D as v,o as f,c as x,E as m,G as _,H as y,I as b,V as w,j as $,b as S,f as C,J as I,a as z,K as E,L as j,M as T,_ as L}from"./index-DSBX7T2Q.js";import{_ as O}from"./LoginForm.vue_vue_type_script_setup_true_lang-DoBliif_.js";const R=t("thing","\n display: flex;\n transition: color .3s var(--n-bezier);\n font-size: var(--n-font-size);\n color: var(--n-text-color);\n",[t("thing-avatar","\n margin-right: 12px;\n margin-top: 2px;\n "),t("thing-avatar-header-wrapper","\n display: flex;\n flex-wrap: nowrap;\n ",[t("thing-header-wrapper","\n flex: 1;\n ")]),t("thing-main","\n flex-grow: 1;\n ",[t("thing-header","\n display: flex;\n margin-bottom: 4px;\n justify-content: space-between;\n align-items: center;\n ",[e("title","\n font-size: 16px;\n font-weight: var(--n-title-font-weight);\n transition: color .3s var(--n-bezier);\n color: var(--n-title-text-color);\n ")]),e("description",[n("&:not(:last-child)","\n margin-bottom: 4px;\n ")]),e("content",[n("&:not(:first-child)","\n margin-top: 12px;\n ")]),e("footer",[n("&:not(:first-child)","\n margin-top: 12px;\n ")]),e("action",[n("&:not(:first-child)","\n margin-top: 12px;\n ")])])]),k=a({name:"Thing",props:Object.assign(Object.assign({},r.props),{title:String,titleExtra:String,description:String,descriptionClass:String,descriptionStyle:[String,Object],content:String,contentClass:String,contentStyle:[String,Object],contentIndented:Boolean}),setup(t,{slots:e}){const{mergedClsPrefixRef:n,inlineThemeDisabled:a,mergedRtlRef:p}=i(t),u=r("Thing","-thing",R,s,t,n),g=l("Thing",p,n),v=o((()=>{const{self:{titleTextColor:t,textColor:e,titleFontWeight:n,fontSize:a},common:{cubicBezierEaseInOut:i}}=u.value;return{"--n-bezier":i,"--n-font-size":a,"--n-text-color":e,"--n-title-font-weight":n,"--n-title-text-color":t}})),f=a?d("thing",void 0,v,t):void 0;return()=>{var i;const{value:r}=n,s=!!g&&g.value;return null===(i=null==f?void 0:f.onRender)||void 0===i||i.call(f),c("div",{class:[`${r}-thing`,null==f?void 0:f.themeClass,s&&`${r}-thing--rtl`],style:a?void 0:v.value},e.avatar&&t.contentIndented?c("div",{class:`${r}-thing-avatar`},e.avatar()):null,c("div",{class:`${r}-thing-main`},!t.contentIndented&&(e.header||t.title||e["header-extra"]||t.titleExtra||e.avatar)?c("div",{class:`${r}-thing-avatar-header-wrapper`},e.avatar?c("div",{class:`${r}-thing-avatar`},e.avatar()):null,e.header||t.title||e["header-extra"]||t.titleExtra?c("div",{class:`${r}-thing-header-wrapper`},c("div",{class:`${r}-thing-header`},e.header||t.title?c("div",{class:`${r}-thing-header__title`},e.header?e.header():t.title):null,e["header-extra"]||t.titleExtra?c("div",{class:`${r}-thing-header__extra`},e["header-extra"]?e["header-extra"]():t.titleExtra):null),e.description||t.description?c("div",{class:[`${r}-thing-main__description`,t.descriptionClass],style:t.descriptionStyle},e.description?e.description():t.description):null):null):c(h,null,e.header||t.title||e["header-extra"]||t.titleExtra?c("div",{class:`${r}-thing-header`},e.header||t.title?c("div",{class:`${r}-thing-header__title`},e.header?e.header():t.title):null,e["header-extra"]||t.titleExtra?c("div",{class:`${r}-thing-header__extra`},e["header-extra"]?e["header-extra"]():t.titleExtra):null):null,e.description||t.description?c("div",{class:[`${r}-thing-main__description`,t.descriptionClass],style:t.descriptionStyle},e.description?e.description():t.description):null),e.default||t.content?c("div",{class:[`${r}-thing-main__content`,t.contentClass],style:t.contentStyle},e.default?e.default():t.content):null,e.footer?c("div",{class:`${r}-thing-main__footer`},e.footer()):null,e.action?c("div",{class:`${r}-thing-main__action`},e.action()):null))}}}),B={class:"login-view"},F={class:"card-wrap"},A=["disabled"],V=L(a({__name:"Login",setup(t){const e=p(),n=u(!1);g(n,(t=>{t&&E((()=>{l()}))}),{immediate:!0});const a=u(!1),i=async t=>{try{a.value=!0;let{username:n,password:i}=t;const r=await b.userLogin(n,i),{access_token:s}=r;if(!s)return void window.$message.error("Invalid token!");localStorage.setItem(j.LS_KEY_AUTHORIZATION,s),await e.push({path:"/"})}catch(n){console.error(n)}finally{a.value=!1}},r=()=>{n.value?o.value.handleValidate():i({username:"x",password:"x"})},s=u(),l=()=>{var t;null==(t=s.value)||t.focus()},o=u();return v((async()=>{await(async()=>{try{a.value=!0;const t=await b.hasUsers();n.value=t||!1}catch(t){console.error(t)}finally{a.value=!1}})()})),(t,e)=>{const s=k,l=T;return f(),x("div",B,[m(y,null,{default:_((()=>[m(w,{"show-close":!1},{titleBarLeft:_((()=>[$("Login")])),default:_((()=>[S("div",F,[C(m(O,{ref_key:"loginFormRef",ref:o,onSubmit:i,disabled:z(a)},null,8,["disabled"]),[[I,z(n)]]),C(m(s,null,{header:_((()=>[$(" ℹ️ Tips ")])),description:_((()=>[$(" There is no registered user, please log in and register in the settings. You can log in directly when you log in for the first time. ")])),_:1},512),[[I,!z(n)]]),m(l,{size:"small",justify:"end"},{default:_((()=>[S("button",{class:"vp-button",type:"button",onClick:e[0]||(e[0]=e=>t.$router.push({name:"IpChooserView"}))}," IP "),S("button",{class:"vp-button btn-login",type:"button",onClick:r,disabled:z(a)}," Login ",8,A)])),_:1})])])),_:1})])),_:1})])}}}),[["__scopeId","data-v-43bff7e5"]]);export{V as default};
