import{V as e}from"./index-Bc-2Q8zN.js";import{r as a,O as l,aC as s,d as t,q as o,c as n,F as i,j as u,s as r,a as p,h as v,e as d,aP as c,k as m,_ as f,ag as k,w as _,aQ as b,y as w,m as y,az as h,aF as x,aR as C}from"./index-CQGI0j3m.js";import{F}from"./FileSelector-CQLzKUfp.js";import"./index.vue_vue_type_style_index_0_lang-BTcfxDNl.js";const g=()=>{const e=a(!1);return(e=>{const a=a=>{if(e())return a.preventDefault(),a.returnValue="There is unsaved data.",!0};l((()=>{window.addEventListener("beforeunload",a)})),s((()=>{window.removeEventListener("beforeunload",a)}))})((()=>e.value)),{isChanged:e}},E={key:0,class:"quick-menu-strip"},P={key:0,class:"option-split"},S=["onClick"],T=f(t({__name:"QuickMenuStrip",props:{options:{}},emits:[],setup(e,{emit:l}){const s=a(),t=a([]),f=a(-1),k=()=>{t.value=[],f.value=-1};return(e,a)=>e.options&&e.options.length?(o(),n("div",E,[(o(!0),n(i,null,u(e.options,((e,a)=>(o(),n(i,{key:a},[e.split?(o(),n("div",P)):(o(),n("button",{key:1,class:r(["btn-no-style btn-menu",{active:p(f)===a}]),onClick:l=>((e,a,l)=>{s.value.showMenuByElement(e.target,"bottom-left"),setTimeout((()=>{t.value=a.children||[],f.value=l}))})(l,e,a)},v(e.label),11,S))],64)))),128)),d(c,{ref_key:"verticalMenuRef",ref:s,onOnClose:k,options:p(t)},null,8,["options"])])):m("",!0)}}),[["__scopeId","data-v-0d5f90f5"]]),j=f(t({name:"TextEditor",props:{task:{},appParams:{}},emits:[],setup(s,{emit:t}){const i=s,u=t,{task:r}=k(i),v=a(""),c=a(""),{isChanged:m}=g();_(c,(()=>{m.value=!0})),_(m,(e=>{r.value&&(r.value.title=e?`* ${v.value}`:`${v.value}`)}));const f=async e=>{console.log(e);const{item:a,basePath:l}=e;v.value=h(l+"/"+a.name),c.value=await x.readFile(v.value),setTimeout((()=>{m.value=!1}))};l((()=>{i.appParams&&f(i.appParams)}));const E=a(),P=a();b(P,(()=>{E.value.resize()}));const S=a(),j=w((()=>[{label:"File",children:[{label:"New",props:{onClick(){c.value="",v.value="",setTimeout((()=>{m.value=!1}))}}},{label:"Open...",props:{onClick(){S.value.show()}}},v.value&&{label:"Save",props:{onClick(){(async()=>{if(!v.value)throw new Error("editFullPath not exist!");const e=v.value.lastIndexOf("/")+1,a=v.value.slice(e);await x.uploadFile({path:v.value,file:C(c.value,a)}),setTimeout((()=>{m.value=!1}))})()}}},{label:"Save As...",props:{onClick(){}}},{split:!0},{label:"Exit!",props:{onClick(){u("exitApp")}}}].filter(Boolean)}]));return(a,l)=>(o(),n("div",{class:"text-editor-wrap",ref_key:"rootRef",ref:P},[d(T,{options:p(j)},null,8,["options"]),d(F,{"show-button":!1,ref_key:"fileSelectorRef",ref:S,onHandleSelect:f},null,512),d(e,{modelValue:p(c),"onUpdate:modelValue":l[0]||(l[0]=e=>y(c)?c.value=e:null),ref_key:"vueMonacoRef",ref:E},null,8,["modelValue"])],512))}}),[["__scopeId","data-v-d1d2d7eb"]]);export{j as default};
