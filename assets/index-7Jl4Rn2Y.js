import{e,F as a,G as t,Q as l,O as n,be as i,bd as s,bK as o,bL as r,bM as c,bN as u,bD as d,l as p,P as m,H as v,I as h,T as y,aR as f,aV as w,at as g,bi as b,bc as k,J as x,bO as C,_,bP as I,bf as L,bg as A,bk as T,r as P,w as S,y as M,bQ as E,o as D,K as N,a2 as R,bj as B,bw as z,Y as O,bR as $,bE as K,bS as V,bT as F,as as j,ba as H,bb as Y,bC as U}from"./index-Bm5q-7YB.js";import{n as G,f as q,i as W}from"./is-DLZNQrwQ.js";import{_ as J}from"./Slider-C1aOIkor.js";import{_ as Q}from"./Space-CXJL1bL4.js";const X={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Z=[l("g",{fill:"none"},[l("path",{d:"M16.5 6.671c.116 0 .223.04.308.107l.067.063l.017.02a5 5 0 0 1-3.675 8.135L13 15H7a5.07 5.07 0 0 1-.303-.009l1.657 1.655a.5.5 0 0 1 .057.638l-.057.07a.5.5 0 0 1-.638.057l-.07-.057l-2.5-2.5a.5.5 0 0 1-.057-.638l.057-.07l2.5-2.5a.5.5 0 0 1 .765.638l-.057.07l-1.637 1.636l.14.008L7 14h6a4 4 0 0 0 3.11-6.516a.5.5 0 0 1 .39-.812zm-4.854-4.025a.5.5 0 0 1 .638-.057l.07.057l2.5 2.5l.057.07a.5.5 0 0 1 0 .568l-.057.07l-2.5 2.5l-.07.057a.5.5 0 0 1-.568 0l-.07-.057l-.057-.07a.5.5 0 0 1 0-.568l.057-.07l1.637-1.636l-.14-.008L13 6H7a4 4 0 0 0-3.105 6.522a.5.5 0 1 1-.801.601a5 5 0 0 1 3.689-8.119L7 5h6c.102 0 .203.003.303.009l-1.657-1.655l-.057-.07a.5.5 0 0 1 .057-.638z",fill:"currentColor"})],-1)],ee=e({name:"ArrowRepeatAll20Regular",render:function(e,l){return a(),t("svg",X,Z)}}),ae={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},te=[l("g",{fill:"none"},[l("path",{d:"M15.987 3.016a1 1 0 0 0-1.285-.79l-7 2.187A1 1 0 0 0 7 5.368V13.5a2.5 2.5 0 1 0 1 2V8.368l7-2.188v5.32a2.5 2.5 0 1 0 1 2V3.18c0-.056-.005-.11-.013-.164z",fill:"currentColor"})],-1)],le=e({name:"MusicNote220Filled",render:function(e,l){return a(),t("svg",ae,te)}}),ne={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},ie=[l("g",{fill:"none"},[l("path",{d:"M3 4.252c0-1 1.116-1.595 1.947-1.038l8.499 5.707a1.25 1.25 0 0 1 .007 2.071l-8.5 5.793A1.25 1.25 0 0 1 3 15.752v-11.5zM17 3.5a.5.5 0 0 0-1 0v13a.5.5 0 1 0 1 0v-13z",fill:"currentColor"})],-1)],se=e({name:"Next20Filled",render:function(e,l){return a(),t("svg",ne,ie)}}),oe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},re=[l("g",{fill:"none"},[l("path",{d:"M12 3.5A1.5 1.5 0 0 1 13.5 2h2A1.5 1.5 0 0 1 17 3.5v13a1.5 1.5 0 0 1-1.5 1.5h-2a1.5 1.5 0 0 1-1.5-1.5v-13zm-9 0A1.5 1.5 0 0 1 4.5 2h2A1.5 1.5 0 0 1 8 3.5v13A1.5 1.5 0 0 1 6.5 18h-2A1.5 1.5 0 0 1 3 16.5v-13z",fill:"currentColor"})],-1)],ce=e({name:"Pause20Filled",render:function(e,l){return a(),t("svg",oe,re)}}),ue={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},de=[l("g",{fill:"none"},[l("path",{d:"M9 7.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5zm3 0a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5zM10 2a8 8 0 1 0 0 16a8 8 0 0 0 0-16zm-7 8a7 7 0 1 1 14 0a7 7 0 0 1-14 0z",fill:"currentColor"})],-1)],pe=e({name:"PauseCircle20Regular",render:function(e,l){return a(),t("svg",ue,de)}}),me={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},ve=[l("g",{fill:"none"},[l("path",{d:"M17.222 8.685a1.5 1.5 0 0 1 0 2.628l-10 5.498A1.5 1.5 0 0 1 5 15.496V4.502a1.5 1.5 0 0 1 2.223-1.314l10 5.497z",fill:"currentColor"})],-1)],he=e({name:"Play20Filled",render:function(e,l){return a(),t("svg",me,ve)}}),ye={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},fe=[l("g",{fill:"none"},[l("path",{d:"M9.125 7.184A.75.75 0 0 0 8 7.834v4.333a.75.75 0 0 0 1.125.65l4.125-2.384a.5.5 0 0 0 0-.866L9.125 7.184zM2 10a8 8 0 1 1 16 0a8 8 0 0 1-16 0zm8-7a7 7 0 1 0 0 14a7 7 0 0 0 0-14z",fill:"currentColor"})],-1)],we=e({name:"PlayCircle20Regular",render:function(e,l){return a(),t("svg",ye,fe)}}),ge={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},be=[l("g",{fill:"none"},[l("path",{d:"M17 4.252c0-1-1.116-1.595-1.947-1.038L6.554 8.921a1.25 1.25 0 0 0-.007 2.071l8.5 5.793A1.25 1.25 0 0 0 17 15.752v-11.5zM3 3.5a.5.5 0 0 1 1 0v13a.5.5 0 0 1-1 0v-13z",fill:"currentColor"})],-1)],ke=e({name:"Previous20Filled",render:function(e,l){return a(),t("svg",ge,be)}}),xe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Ce=[l("g",{fill:"none"},[l("path",{d:"M12 3.006c0-.873-1.04-1.327-1.68-.733L6.448 5.866a.5.5 0 0 1-.34.134H3.5A1.5 1.5 0 0 0 2 7.5v5A1.5 1.5 0 0 0 3.5 14h2.607a.5.5 0 0 1 .34.133l3.873 3.594c.64.593 1.68.14 1.68-.733V3.006zm3.254 1.621a.5.5 0 0 1 .706.04a8 8 0 0 1 0 10.666a.5.5 0 1 1-.745-.667a7 7 0 0 0 0-9.333a.5.5 0 0 1 .039-.706zm-1.175 8.306a.5.5 0 0 1-.184-.683a4.498 4.498 0 0 0 0-4.5a.5.5 0 1 1 .865-.5a5.498 5.498 0 0 1 .001 5.5a.5.5 0 0 1-.682.183z",fill:"currentColor"})],-1)],_e=e({name:"Speaker220Filled",render:function(e,l){return a(),t("svg",xe,Ce)}}),Ie={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Le=[l("g",{fill:"none"},[l("path",{d:"M2.854 2.146a.5.5 0 1 0-.708.708L5.293 6H3.497a1.5 1.5 0 0 0-1.5 1.5v5a1.5 1.5 0 0 0 1.5 1.5h2.608a.5.5 0 0 1 .34.133l3.872 3.594c.64.594 1.68.14 1.68-.733v-4.29l5.15 5.15a.5.5 0 0 0 .707-.708l-2.563-2.562L2.854 2.146zm8.143 9.558v5.29L7.125 13.4a1.5 1.5 0 0 0-1.02-.4H3.497a.5.5 0 0 1-.5-.5v-5a.5.5 0 0 1 .5-.5h2.608c.06 0 .119-.004.177-.01l4.715 4.714zm0-8.698v5.87l1 1v-6.87c0-.873-1.04-1.327-1.68-.733l-3.072 2.85l.708.708l3.044-2.825zm3.064 8.934l.742.741a5.497 5.497 0 0 0-.04-5.431a.5.5 0 0 0-.866.5c.77 1.333.78 2.896.164 4.19zm1.835 1.835l.722.722a8.004 8.004 0 0 0-.655-9.83a.5.5 0 1 0-.745.667a7.004 7.004 0 0 1 .678 8.441z",fill:"currentColor"})],-1)],Ae=e({name:"SpeakerOff20Regular",render:function(e,l){return a(),t("svg",Ie,Le)}}),Te={name:"CoverDisplay",props:{src:{type:String,default:null},isRounded:{type:Boolean,default:!1},isRotating:{type:Boolean,default:!1},isShowIcon:{type:Boolean,default:!0}}},Pe={class:"cover-display"},Se=["src"],Me={key:1,class:"cover-icon"};const Ee=n(Te,[["render",function(e,l,n,o,r,c){return a(),t("div",Pe,[n.src?(a(),t("img",{key:0,src:n.src,class:i({rounded:n.isRounded,rotating:n.isRotating})},null,10,Se)):n.isShowIcon?(a(),t("span",Me,"CC")):s("",!0)])}],["__scopeId","data-v-00511d1e"]]);class De{constructor(e,a){this.guid=d(),this.filename=e,this.basePath=a}get absPath(){return G(this.basePath+"/"+this.filename)}get titleDisplay(){return this.filename}}const Ne=[1,2,3,4,5],Re={1:{value:1,i18nKey:"msg.play-in-order"},5:{value:5,i18nKey:"shuffle"},2:{value:2,icon:ee,i18nKey:"msg.sequential-loop"},3:{value:3,icon:ee,className:"reverse-x",i18nKey:"msg.reverse-loop"},4:{value:4,i18nKey:"msg.single-cycle"}},Be=o("music",{state:()=>({musicItem:null,playingList:[],playingIndex:0,paused:!0,currentTime:0,duration:0,playbackRate:1,stopCountdown:null,isPlayEnded:!1,isLoadedAutoplay:!0}),actions:{playFromList(e=[],a=0){const t=e[a];t?(this.playingList=e,this.playingIndex=a,this.musicItem=t,this.isLoadedAutoplay=!0):window.$message.error(`index=${a} not found`)},playPrev(){let e=this.playingIndex-1;e<0&&(e=this.playingList.length-1),this.playByIndex(e)},playShuffle(){this.playByIndex(function(e,a){const t=e.reduce(((e,t,l)=>(l!==a&&e.push(l),e)),[]);return t[u(0,t.length-1)]}(this.playingList,this.playingIndex))},playNext(){const e=ze();if(5===e.loopMode)return void this.playShuffle();let a=this.playingIndex+1;if(a>this.playingList.length-1){if(2!==e.loopMode)return;a=0}this.playByIndex(a)},handlePlayEnded(){const e=ze();this.isPlayEnded=!0,4!==e.loopMode?3!==e.loopMode?5!==e.loopMode?this.playNext():this.playShuffle():this.playPrev():r.emit(c.ACTION_PLAY)},playByIndex(e){this.musicItem=this.playingList[e],this.playingIndex=e,console.log("[playByIndex]",e,this.musicItem),setTimeout((()=>{this.isPlayEnded?(r.emit(c.ACTION_PLAY),this.isPlayEnded=!1):this.paused&&r.emit(c.ACTION_PLAY)}),100)}}}),ze=o("musicSettings",{state:()=>({loopMode:2,audioVolume:100}),actions:{setAudioVolume(e){(e=Number(e))>100&&(e=100),e<0&&(e=0),this.audioVolume=e},volumeUp(e=5){const a=this.audioVolume+e;this.setAudioVolume(a)},volumeDown(e=5){const a=this.audioVolume-e;this.setAudioVolume(a)}},persist:{key:"ls_key_canos_music_settings"}}),Oe={LYRIC:"LYRIC",METADATA:"METADATA"},$e=e({name:"MusicDetail",components:{CoverDisplay:Ee},data(){return{currentDetailTab:Oe.LYRIC,DetailTabEnum:Oe,detailTabList:[{label:this.$t("lyric"),value:Oe.LYRIC},{label:this.$t("metadata"),value:Oe.METADATA}],isShowDetail:!1,isShowLyricSearch:!1,isLyricLock:!1,lyricObj:null,isShowPlaybackRate:!1,isShowCountdownConfig:!1}},setup(){const e=Be();return{musicStore:e,musicItem:p((()=>e.musicItem)),jumpForward(){r.emit(c.ACTION_CHANGE_CURRENT_TIME,e.currentTime+=5)},jumpBackward(){r.emit(c.ACTION_CHANGE_CURRENT_TIME,e.currentTime-=5)},handlePlaybackRateChange(a){e.playbackRate=Number(a)}}}}),Ke=e=>(L("data-v-ca096697"),e=e(),A(),e),Ve={key:0,class:"music-detail"},Fe={class:"cover-wrap"},je={class:"detail-content bg-dark"},He={class:"tab-wrap"},Ye=["onClick"],Ue={class:"lyric-content"},Ge={class:"lyric-lock"},qe=["title"],We=[Ke((()=>l("i",{class:"material-icons"},"search",-1)))],Je=["title"],Qe={class:"material-icons"},Xe=["value","placeholder"],Ze={class:"below-wrap"},ea={class:"title"},aa={class:"subtitle"},ta={class:"subtitle"},la={class:"actions-wrap"},na=[Ke((()=>l("i",{class:"material-icons"},"replay_5",-1)))],ia=["title"],sa=[Ke((()=>l("i",{class:"material-icons"},"speed",-1)))],oa=[Ke((()=>l("i",{class:"material-icons"},"forward_5",-1)))];const ra=n($e,[["render",function(e,n,o,r,c,u){const d=m("CoverDisplay"),p=C,L=_,A=J,T=Q,P=I;return e.musicItem?(a(),t("div",Ve,[v(p,{class:"cover-wrap-box"},{default:h((()=>[l("div",Fe,[v(d,{class:"big-cover",src:e.musicItem.cover,"is-rotating":!1,"is-rounded":!1,"is-show-icon":!1,onClick:n[0]||(n[0]=a=>e.isShowDetail=!0)},null,8,["src"]),v(y,{name:"fade"},{default:h((()=>[f(l("div",je,[l("div",He,[(a(!0),t(g,null,b(e.detailTabList,(l=>(a(),t("button",{key:l.value,class:i([{active:e.currentDetailTab===l.value},"btn-no-style"]),onClick:a=>e.currentDetailTab=l.value},k(l.label),11,Ye)))),128))]),f(l("div",Ue,[l("div",Ge,[l("button",{class:"btn-no-style",title:e.$t("search-lyric"),onClick:n[1]||(n[1]=a=>e.isShowLyricSearch=!0)},We,8,qe),l("button",{class:"btn-no-style",title:e.$t("lock-lyric"),onClick:n[2]||(n[2]=a=>e.isLyricLock=!e.isLyricLock)},[l("i",Qe,k(e.isLyricLock?"lock":"lock_open"),1)],8,Je)]),l("div",{class:"lrc-main no-lyric",onClick:n[3]||(n[3]=a=>e.isShowDetail=!1)},k(e.$t("msg.no-lyric"))+" TBD ",1)],512),[[w,e.currentDetailTab===e.DetailTabEnum.LYRIC]]),f(l("textarea",{class:"metadata",cols:"30",rows:"15",readonly:"",value:JSON.stringify(e.musicItem,null,2),placeholder:e.$t("msg.no-data")},null,8,Xe),[[w,e.currentDetailTab===e.DetailTabEnum.METADATA]])],512),[[w,e.isShowDetail]])])),_:1})])])),_:1}),l("div",Ze,[l("div",{class:i(["titles-wrap",{opacity:e.isShowDetail}]),onClick:n[4]||(n[4]=a=>e.isShowDetail=!e.isShowDetail)},[l("div",ea,k(e.musicItem.titleDisplay),1),l("div",aa,k(e.musicItem.artisDisplay),1),l("div",ta,k(e.musicItem.album),1)],2),l("div",la,[l("button",{class:"btn-no-style",onClick:n[5]||(n[5]=(...a)=>e.jumpBackward&&e.jumpBackward(...a))},na),l("button",{class:"btn-no-style",title:e.$t("playback-speed"),onClick:n[6]||(n[6]=a=>e.isShowPlaybackRate=!0)},sa,8,ia),l("button",{class:"btn-no-style",onClick:n[7]||(n[7]=(...a)=>e.jumpForward&&e.jumpForward(...a))},oa)])]),v(P,{show:e.isShowPlaybackRate,"onUpdate:show":n[11]||(n[11]=a=>e.isShowPlaybackRate=a),preset:"dialog","show-icon":!1,title:e.$t("playback-speed")},{default:h((()=>[v(T,{align:"center"},{default:h((()=>[v(L,{onClick:n[8]||(n[8]=a=>e.handlePlaybackRateChange(1))},{default:h((()=>[x("重置")])),_:1}),v(A,{style:{width:"200px"},value:e.musicStore.playbackRate,"onUpdate:value":[n[9]||(n[9]=a=>e.musicStore.playbackRate=a),n[10]||(n[10]=a=>e.handlePlaybackRateChange(e.musicStore.playbackRate))],step:"marks",max:2,min:.2,marks:{.2:"0.2",.5:"0.5",1:"1",1.2:"1.2",1.5:"1.5",2:"2"}},null,8,["value"])])),_:1})])),_:1},8,["show","title"]),v(P,{show:e.isShowLyricSearch,"onUpdate:show":n[12]||(n[12]=a=>e.isShowLyricSearch=a),preset:"dialog","show-icon":!1,title:"Search Lyric"},{default:h((()=>[x("TBD ")])),_:1},8,["show"])])):s("",!0)}],["__scopeId","data-v-ca096697"]]),ca={class:"player-core"},ua=["src"],da=e({__name:"PlayerCore",setup(e){const n=Be(),{t:i}=T(),s=P(),o=ze(),r=P(),u=()=>{s.value.play()},d=()=>{s.value.pause()},p=()=>{n.playPrev()},m=()=>{n.playNext()},v=e=>{s.value&&(s.value.volume=e/100)},h=(e=1)=>{if(s.value)try{s.value.playbackRate=e}catch(a){window.$message.error(a.message)}};return S((()=>o.audioVolume),v),S((()=>n.playbackRate),h),S((()=>n.musicItem),(async e=>{e||(r.value=void 0);const{key:a}=await q.createShareLink({paths:[e.absPath]});r.value=q.getStreamShareLink(a)}),{immediate:!0}),M((()=>{var e;e=s.value,"mediaSession"in navigator&&(navigator.mediaSession.setActionHandler("play",u),navigator.mediaSession.setActionHandler("pause",d),navigator.mediaSession.setActionHandler("previoustrack",p),navigator.mediaSession.setActionHandler("nexttrack",m)),e.addEventListener("play",(()=>{n.paused=!1,n.isLoadedAutoplay=!0})),e.addEventListener("pause",(()=>{n.paused=!0,n.isLoadedAutoplay=!1})),e.addEventListener("ended",(()=>{n.handlePlayEnded()})),e.addEventListener("canplay",(e=>{n.duration=e.target.duration,n.isLoadedAutoplay&&u()})),e.addEventListener("timeupdate",(e=>{n.currentTime=e.target.currentTime})),e.addEventListener("error",(e=>{console.error(e),window.$message.error(i("msg.load-fail-or-no-supported-source"))})),v(o.audioVolume),h(n.playbackRate)})),E(c.ACTION_TOGGLE_PLAY,(()=>{s.value&&s.value.src&&(s.value.paused?u():d())})),E(c.ACTION_PLAY,u),E(c.ACTION_PAUSE,d),E(c.ACTION_CHANGE_CURRENT_TIME,(e=>{s.value&&(s.value.currentTime=e)})),D((()=>{})),(e,n)=>(a(),t("div",ca,[l("audio",{ref_key:"audioRef",ref:s,src:N(r),controls:""},null,8,ua)]))}}),pa={class:"btn-no-style btn-cover flex items-center justify-center"},ma={key:1,class:"icon-wrap"},va=n(e({__name:"CoverMini",props:{src:{}},setup:e=>(e,l)=>(a(),t("button",pa,[R(e.$slots,"default",{},void 0,!0),e.src?(a(),B(Ee,{key:0,src:e.src},null,8,["src"])):(a(),t("i",ma,[v(N(le))]))]))}),[["__scopeId","data-v-fa899b89"]]),ha={name:"TkSeekbar",props:{min:{type:[Number,String],default:0},max:{type:[Number,String],default:100},value:{type:[Number,String],default:100},vertical:{type:Boolean,default:!1},wheel:{type:Boolean,default:!1}},emits:["input","focus","blur","change"],computed:{progress(){return(this.value/this.max*100).toFixed(1)}},methods:{handleInput(e){this.$emit("input",e.target.value)},handleFocus(e){this.$emit("focus",e)},handleBlur(e){this.$emit("blur",e)},handleChange(e){this.$emit("change",e.target.value)},handleWheel(e){if(this.wheel){e.preventDefault();const a=this.$refs.seekBar,t=e.deltaY||0,l=Math.abs(t)/64;t>0?a.value=this.value-l:t<0&&(a.value=this.value+l),this.$emit("input",a.value)}}}},ya=["min","max","value"];const fa=n(ha,[["render",function(e,n,o,r,c,u){return a(),t("div",{class:i(["tk-seekbar",{vertical:o.vertical}])},[o.vertical?s("",!0):(a(),t("div",{key:0,class:"seekbar-fill",style:z("width:"+u.progress+"%")},null,4)),l("input",O({ref:"seekBar",type:"range",min:o.min,max:o.max,value:o.value,class:"common-seekbar seekbar-input"},e.$attrs,{onInput:n[0]||(n[0]=(...e)=>u.handleInput&&u.handleInput(...e)),onFocus:n[1]||(n[1]=(...e)=>u.handleFocus&&u.handleFocus(...e)),onBlur:n[2]||(n[2]=(...e)=>u.handleBlur&&u.handleBlur(...e)),onChange:n[3]||(n[3]=(...e)=>u.handleChange&&u.handleChange(...e)),onWheel:n[4]||(n[4]=(...e)=>u.handleWheel&&u.handleWheel(...e))}),null,16,ya)],2)}],["__scopeId","data-v-fc3749d0"]]);var wa,ga={exports:{}};wa=ga,function(e,a,t){if(e){for(var l,n={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},i={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},o={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},r=1;r<20;++r)n[111+r]="f"+r;for(r=0;r<=9;++r)n[r+96]=r.toString();h.prototype.bind=function(e,a,t){var l=this;return e=e instanceof Array?e:[e],l._bindMultiple.call(l,e,a,t),l},h.prototype.unbind=function(e,a){return this.bind.call(this,e,(function(){}),a)},h.prototype.trigger=function(e,a){var t=this;return t._directMap[e+":"+a]&&t._directMap[e+":"+a]({},e),t},h.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},h.prototype.stopCallback=function(e,a){if((" "+a.className+" ").indexOf(" mousetrap ")>-1)return!1;if(v(a,this.target))return!1;if("composedPath"in e&&"function"==typeof e.composedPath){var t=e.composedPath()[0];t!==e.target&&(a=t)}return"INPUT"==a.tagName||"SELECT"==a.tagName||"TEXTAREA"==a.tagName||a.isContentEditable},h.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},h.addKeycodes=function(e){for(var a in e)e.hasOwnProperty(a)&&(n[a]=e[a]);l=null},h.init=function(){var e=h(a);for(var t in e)"_"!==t.charAt(0)&&(h[t]=function(a){return function(){return e[a].apply(e,arguments)}}(t))},h.init(),e.Mousetrap=h,wa.exports&&(wa.exports=h)}function c(e,a,t){e.addEventListener?e.addEventListener(a,t,!1):e.attachEvent("on"+a,t)}function u(e){if("keypress"==e.type){var a=String.fromCharCode(e.which);return e.shiftKey||(a=a.toLowerCase()),a}return n[e.which]?n[e.which]:i[e.which]?i[e.which]:String.fromCharCode(e.which).toLowerCase()}function d(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function p(e,a,t){return t||(t=function(){if(!l)for(var e in l={},n)e>95&&e<112||n.hasOwnProperty(e)&&(l[n[e]]=e);return l}()[e]?"keydown":"keypress"),"keypress"==t&&a.length&&(t="keydown"),t}function m(e,a){var t,l,n,i=[];for(t=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),n=0;n<t.length;++n)l=t[n],o[l]&&(l=o[l]),a&&"keypress"!=a&&s[l]&&(l=s[l],i.push("shift")),d(l)&&i.push(l);return{key:l,modifiers:i,action:a=p(l,i,a)}}function v(e,t){return null!==e&&e!==a&&(e===t||v(e.parentNode,t))}function h(e){var t=this;if(e=e||a,!(t instanceof h))return new h(e);t.target=e,t._callbacks={},t._directMap={};var l,n={},i=!1,s=!1,o=!1;function r(e){e=e||{};var a,t=!1;for(a in n)e[a]?t=!0:n[a]=0;t||(o=!1)}function p(e,a,l,i,s,o){var r,c,u,p,m=[],v=l.type;if(!t._callbacks[e])return[];for("keyup"==v&&d(e)&&(a=[e]),r=0;r<t._callbacks[e].length;++r)if(c=t._callbacks[e][r],(i||!c.seq||n[c.seq]==c.level)&&v==c.action&&("keypress"==v&&!l.metaKey&&!l.ctrlKey||(u=a,p=c.modifiers,u.sort().join(",")===p.sort().join(",")))){var h=!i&&c.combo==s,y=i&&c.seq==i&&c.level==o;(h||y)&&t._callbacks[e].splice(r,1),m.push(c)}return m}function v(e,a,l,n){t.stopCallback(a,a.target||a.srcElement,l,n)||!1===e(a,l)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(a),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(a))}function y(e){"number"!=typeof e.which&&(e.which=e.keyCode);var a=u(e);a&&("keyup"!=e.type||i!==a?t.handleKey(a,function(e){var a=[];return e.shiftKey&&a.push("shift"),e.altKey&&a.push("alt"),e.ctrlKey&&a.push("ctrl"),e.metaKey&&a.push("meta"),a}(e),e):i=!1)}function f(e,a,t,s){function c(a){return function(){o=a,++n[e],clearTimeout(l),l=setTimeout(r,1e3)}}function d(a){v(t,a,e),"keyup"!==s&&(i=u(a)),setTimeout(r,10)}n[e]=0;for(var p=0;p<a.length;++p){var h=p+1===a.length?d:c(s||m(a[p+1]).action);w(a[p],h,s,e,p)}}function w(e,a,l,n,i){t._directMap[e+":"+l]=a;var s,o=(e=e.replace(/\s+/g," ")).split(" ");o.length>1?f(e,o,a,l):(s=m(e,l),t._callbacks[s.key]=t._callbacks[s.key]||[],p(s.key,s.modifiers,{type:s.action},n,e,i),t._callbacks[s.key][n?"unshift":"push"]({callback:a,modifiers:s.modifiers,action:s.action,seq:n,level:i,combo:e}))}t._handleKey=function(e,a,t){var l,n=p(e,a,t),i={},c=0,u=!1;for(l=0;l<n.length;++l)n[l].seq&&(c=Math.max(c,n[l].level));for(l=0;l<n.length;++l)if(n[l].seq){if(n[l].level!=c)continue;u=!0,i[n[l].seq]=1,v(n[l].callback,t,n[l].combo,n[l].seq)}else u||v(n[l].callback,t,n[l].combo);var m="keypress"==t.type&&s;t.type!=o||d(e)||m||r(i),s=u&&"keydown"==t.type},t._bindMultiple=function(e,a,t){for(var l=0;l<e.length;++l)w(e[l],a,t)},c(e,"keypress",y),c(e,"keydown",y),c(e,"keyup",y)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null);const ba=$(ga.exports),ka={key:0,class:"actionbar-wrapper"},xa={class:"progressbar"},Ca={class:"time text-overflow"},_a={class:"time text-overflow"},Ia={class:"actionbar"},La={class:"title text-overflow"},Aa={class:"buttons-scroll"},Ta=["disabled","title"],Pa={class:"icon-wrap"},Sa=["disabled","title"],Ma={class:"icon-wrap _lg"},Ea=["disabled","title"],Da={class:"icon-wrap"},Na=["title"],Ra={key:1},Ba=["title"],za={class:"icon-wrap"},Oa={style:{display:"flex","align-items":"center","flex-direction":"column"}},$a={style:{"font-size":"12px"}},Ka=n(e({__name:"MusicControl",emits:["onCoverClick","onTitleClick"],setup(e,{emit:n}){const o=Be(),u=["left","pageup","k","l"],d=["right","pagedown","h","j"],{t:m}=T(),y=ze(),g=P(0),b=P(!1),x=P(!1),C=K(),_=e=>{e.preventDefault(),r.emit(c.ACTION_TOGGLE_PLAY)},I=()=>{o.playPrev()},L=()=>{o.playNext()},A=e=>{e.preventDefault(),y.volumeUp()},E=e=>{e.preventDefault(),y.volumeDown()},R=()=>{let e=Ne.findIndex((e=>e===y.loopMode));++e,e>Ne.length-1&&(e=0),Ne[e]&&(y.loopMode=Ne[e],window.$message.info(m($.value.i18nKey)))},z=e=>{b.value=!0,g.value=Number(e)},O=e=>{e=Number(e),r.emit(c.ACTION_CHANGE_CURRENT_TIME,e),b.value=!1},$=p((()=>Re[y.loopMode]));M((()=>{const e=new ba;e.bind("space",_),e.bind(u,I),e.bind(d,L),e.bind("ctrl+x",R),e.bind("up",A),e.bind("down",E),C.value=e})),D((()=>{C.value&&C.value.reset()})),S((()=>o.currentTime),(e=>{b.value||(g.value=e)}));const H=p((()=>o.musicItem));return(e,n)=>{const r=J,c=j;return N(H)?(a(),t("div",ka,[l("div",xa,[l("span",Ca,k(N(V)(N(g))),1),v(fa,{max:N(o).duration,value:N(g),onInput:z,onChange:O},null,8,["max","value"]),l("span",_a,k(N(V)(N(o).duration)),1)]),l("div",Ia,[v(va,{src:N(H).cover,"icon-name":"audiotrack",onClick:n[0]||(n[0]=a=>e.$emit("onCoverClick"))},null,8,["src"]),l("button",{class:"btn-song-info btn-no-style",onClick:n[1]||(n[1]=a=>e.$emit("onTitleClick"))},[l("span",La,k(N(H).titleDisplay),1),f(l("span",{class:"artist text-overflow"},k(N(H).artist),513),[[w,N(H).artist]]),f(l("span",{class:"album text-overflow"},k(N(H).album),513),[[w,N(H).album]])]),l("div",Aa,[l("button",{disabled:N(x),class:"btn-action btn-no-style",title:N(m)("previous"),onClick:I},[l("i",Pa,[v(N(ke))])],8,Ta),l("button",{disabled:N(x),class:"btn-action btn-no-style",title:N(o).paused?N(m)("play"):N(m)("pause"),onClick:_},[l("i",Ma,[N(o).paused?(a(),B(N(we),{key:0})):(a(),B(N(pe),{key:1}))])],8,Sa),l("button",{disabled:N(x),class:"btn-action btn-no-style",title:N(m)("next"),onClick:L},[l("i",Da,[v(N(se))])],8,Ea),N($)?(a(),t("button",{key:0,class:"btn-action btn-no-style",title:N(m)(N($).i18nKey),onClick:R},[l("i",{class:i(["icon-wrap",N($).className])},[N($).icon?(a(),B(F(N($).icon),{key:0})):(a(),t("span",Ra,k(N(m)(N($).i18nKey)),1))],2)],8,Na)):s("",!0),v(c,{placement:"top",trigger:"click"},{trigger:h((()=>[l("button",{class:"btn-action btn-no-style",title:N(m)("volume")},[l("i",za,[N(y).audioVolume>0?(a(),B(N(_e),{key:0})):(a(),B(N(Ae),{key:1}))])],8,Ba)])),default:h((()=>[l("div",Oa,[v(r,{vertical:"",style:{height:"100px"},max:100,tooltip:!1,value:N(y).audioVolume,"onUpdate:value":n[2]||(n[2]=e=>N(y).audioVolume=e)},null,8,["value"]),l("span",$a,k(N(y).audioVolume),1)])])),_:1})])])])):s("",!0)}}}),[["__scopeId","data-v-cfe94052"]]),Va={class:"playlist-item"},Fa={class:"item-left"},ja={key:0,class:"status-icon"},Ha={class:"item-main"},Ya={class:"item-title"},Ua={class:"item-subtitle"},Ga=(e=>(L("data-v-f2882324"),e=e(),A(),e))((()=>l("div",{class:"item-right"},null,-1))),qa=n(e({__name:"PlaylistItem",props:{item:{}},setup(e){const n=e,i=Be(),{item:o}=H(n),r=p((()=>{var e;return o.value.guid===(null==(e=i.musicItem)?void 0:e.guid)}));return(e,n)=>(a(),t("div",Va,[l("div",Fa,[N(r)?(a(),t("div",ja,[N(i).paused?(a(),B(N(ce),{key:1})):(a(),B(N(he),{key:0}))])):s("",!0),v(va,{src:N(o).cover,"force-show-icon":""},null,8,["src"])]),l("div",Ha,[l("div",Ya,k(N(o).titleDisplay),1),l("div",Ua,k(N(o).artistsAlbumDisplay),1)]),Ga]))}}),[["__scopeId","data-v-f2882324"]]),Wa={class:"music-play-list"},Ja={class:"vp-bg playlist-action-bar"},Qa=["placeholder"],Xa={class:"music-list"},Za=n(e({__name:"index",setup(e){const n=Be(),i=P(""),s=p((()=>{if(!i.value)return n.playingList;const e=new RegExp(i.value,"ig");return n.playingList.filter((a=>(a.titleDisplay,e.test(a.titleDisplay)||e.test(a.artistsAlbumDisplay))))}));return(e,o)=>(a(),t("div",Wa,[l("div",Ja,[f(l("input",{class:"vp-input",placeholder:e.$t("filter-by-name"),"onUpdate:modelValue":o[0]||(o[0]=e=>U(i)?i.value=e:null)},null,8,Qa),[[Y,N(i)]]),l("span",null,k(N(n).playingIndex+1)+" / "+k(N(n).playingList.length),1)]),l("div",Xa,[(a(!0),t(g,null,b(N(s),(e=>(a(),B(qa,{key:e.guid,item:e,onClick:a=>(e=>{const a=n.playingList.findIndex((a=>a.guid===e.guid));-1!==a?a!==n.playingIndex?n.playByIndex(a):r.emit(c.ACTION_TOGGLE_PLAY):console.error("idx not found!")})(e)},null,8,["item","onClick"])))),128))])]))}}),[["__scopeId","data-v-c14b70ec"]]),et={class:"music-player-wrap"},at={class:"music-above"},tt={class:"music-below"},lt=n(e({__name:"index",props:{appParams:{}},setup(e){const n=e,i=Be();S((()=>n.appParams),(()=>{if(console.log(n.appParams),!n.appParams)return;const{item:e,list:a,basePath:t}=n.appParams,l=a.map((e=>new De(e.name,t))).filter((e=>W(e.filename))),s=l.findIndex((a=>a.filename===e.name));i.playFromList(l,s)}),{immediate:!0});const s=P(!0);return(e,n)=>(a(),t("div",et,[l("div",at,[f(v(Za,null,null,512),[[w,N(s)]]),f(v(ra,null,null,512),[[w,!N(s)]])]),l("div",tt,[v(Ka,{onOnCoverClick:n[0]||(n[0]=e=>s.value=!N(s)),onOnTitleClick:n[1]||(n[1]=e=>s.value=!N(s))}),f(v(da,null,null,512),[[w,!1]])])]))}}),[["__scopeId","data-v-011aa6cc"]]);export{lt as default};
