import{C as e,h as n,a as o,_ as t}from"./VueRender.vue_vue_type_script_lang-C63RU_Cg.js";import{r,w as i,ci as l,cj as a,cc as d,o as s,aD as u,ck as c,aC as p,e as v,j as f,d as h,i as m,cl as b,l as y,p as w,X as x,aO as g,aP as k,aQ as S,T as C,Y as N,a8 as P,bB as R,C as O,at as _,cm as I,cn as z,co as A,cp as $,c as F,aa as B,b as K,a9 as T,a as D,s as j,aK as L,t as M,u as E,f as q,cq as H,ao as U,z as V,A as G,cr as W,as as Q,cs as J,ba as X,ct as Y,F as Z,G as ee,J as ne,bc as oe,K as te,bd as re,O as ie,Q as le,H as ae,cu as de,cv as se,be as ue,bw as ce,bG as pe,cw as ve,y as fe,a1 as he,bi as me,bj as be,I as ye,by as we}from"./index-Bm5q-7YB.js";function xe(e){return n=>{e.value=n?n.$el:null}}const ge=v({name:"DropdownDivider",props:{clsPrefix:{type:String,required:!0}},render(){return f("div",{class:`${this.clsPrefix}-dropdown-divider`})}}),ke=h("n-dropdown-menu"),Se=h("n-dropdown"),Ce=h("n-dropdown-option");function Ne(e,n){return"submenu"===e.type||void 0===e.type&&void 0!==e[n]}function Pe(e){return"divider"===e.type}const Re=v({name:"DropdownOption",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0},parentKey:{type:[String,Number],default:null},placement:{type:String,default:"right-start"},props:Object,scrollable:Boolean},setup(e){const o=m(Se),{hoverKeyRef:t,keyboardKeyRef:l,lastToggledSubmenuKeyRef:a,pendingKeyPathRef:d,activeKeyPathRef:s,animatedRef:u,mergedShowRef:c,renderLabelRef:p,renderIconRef:v,labelFieldRef:f,childrenFieldRef:h,renderOptionRef:g,nodePropsRef:k,menuPropsRef:S}=o,C=m(Ce,null),N=m(ke),P=m(b),R=y((()=>e.tmNode.rawNode)),O=y((()=>{const{value:n}=h;return Ne(e.tmNode.rawNode,n)})),_=y((()=>{const{disabled:n}=e.tmNode;return n})),I=function(e,n,o){if(!n)return e;const t=r(e.value);let l=null;return i(e,(e=>{null!==l&&window.clearTimeout(l),!0===e?o&&!o.value?t.value=!0:l=window.setTimeout((()=>{t.value=!0}),n):t.value=!1})),t}(y((()=>{if(!O.value)return!1;const{key:n,disabled:o}=e.tmNode;if(o)return!1;const{value:r}=t,{value:i}=l,{value:s}=a,{value:u}=d;return null!==r?u.includes(n):null!==i?u.includes(n)&&u[u.length-1]!==n:null!==s&&u.includes(n)})),300,y((()=>null===l.value&&!u.value))),z=y((()=>!!(null==C?void 0:C.enteringSubmenuRef.value))),A=r(!1);function $(){const{parentKey:n,tmNode:o}=e;o.disabled||c.value&&(a.value=n,l.value=null,t.value=o.key)}return w(Ce,{enteringSubmenuRef:A}),{labelField:f,renderLabel:p,renderIcon:v,siblingHasIcon:N.showIconRef,siblingHasSubmenu:N.hasSubmenuRef,menuProps:S,popoverBody:P,animated:u,mergedShowSubmenu:y((()=>I.value&&!z.value)),rawNode:R,hasSubmenu:O,pending:x((()=>{const{value:n}=d,{key:o}=e.tmNode;return n.includes(o)})),childActive:x((()=>{const{value:n}=s,{key:o}=e.tmNode,t=n.findIndex((e=>o===e));return-1!==t&&t<n.length-1})),active:x((()=>{const{value:n}=s,{key:o}=e.tmNode,t=n.findIndex((e=>o===e));return-1!==t&&t===n.length-1})),mergedDisabled:_,renderOption:g,nodeProps:k,handleClick:function(){const{value:n}=O,{tmNode:t}=e;c.value&&(n||t.disabled||(o.doSelect(t.key,t.rawNode),o.doUpdateShow(!1)))},handleMouseMove:function(){const{tmNode:n}=e;n.disabled||c.value&&t.value!==n.key&&$()},handleMouseEnter:$,handleMouseLeave:function(o){if(e.tmNode.disabled)return;if(!c.value)return;const{relatedTarget:r}=o;!r||n({target:r},"dropdownOption")||n({target:r},"scrollbarRail")||(t.value=null)},handleSubmenuBeforeEnter:function(){A.value=!0},handleSubmenuAfterEnter:function(){A.value=!1}}},render(){var n,o;const{animated:t,rawNode:r,mergedShowSubmenu:i,clsPrefix:l,siblingHasIcon:a,siblingHasSubmenu:d,renderLabel:s,renderIcon:u,renderOption:c,nodeProps:p,props:v,scrollable:h}=this;let m=null;if(i){const e=null===(n=this.menuProps)||void 0===n?void 0:n.call(this,r,r.children);m=f(ze,Object.assign({},e,{clsPrefix:l,scrollable:this.scrollable,tmNodes:this.tmNode.children,parentKey:this.tmNode.key}))}const b={class:[`${l}-dropdown-option-body`,this.pending&&`${l}-dropdown-option-body--pending`,this.active&&`${l}-dropdown-option-body--active`,this.childActive&&`${l}-dropdown-option-body--child-active`,this.mergedDisabled&&`${l}-dropdown-option-body--disabled`],onMousemove:this.handleMouseMove,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onClick:this.handleClick},y=null==p?void 0:p(r),w=f("div",Object.assign({class:[`${l}-dropdown-option`,null==y?void 0:y.class],"data-dropdown-option":!0},y),f("div",N(b,v),[f("div",{class:[`${l}-dropdown-option-body__prefix`,a&&`${l}-dropdown-option-body__prefix--show-icon`]},[u?u(r):P(r.icon)]),f("div",{"data-dropdown-option":!0,class:`${l}-dropdown-option-body__label`},s?s(r):P(null!==(o=r[this.labelField])&&void 0!==o?o:r.title)),f("div",{"data-dropdown-option":!0,class:[`${l}-dropdown-option-body__suffix`,d&&`${l}-dropdown-option-body__suffix--has-submenu`]},this.hasSubmenu?f(R,null,{default:()=>f(e,null)}):null)]),this.hasSubmenu?f(g,null,{default:()=>[f(k,null,{default:()=>f("div",{class:`${l}-dropdown-offset-container`},f(S,{show:this.mergedShowSubmenu,placement:this.placement,to:h&&this.popoverBody||void 0,teleportDisabled:!h},{default:()=>f("div",{class:`${l}-dropdown-menu-wrapper`},t?f(C,{onBeforeEnter:this.handleSubmenuBeforeEnter,onAfterEnter:this.handleSubmenuAfterEnter,name:"fade-in-scale-up-transition",appear:!0},{default:()=>m}):m)}))})]}):null);return c?c({node:w,option:r}):w}}),Oe=v({name:"DropdownGroupHeader",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(){const{showIconRef:e,hasSubmenuRef:n}=m(ke),{renderLabelRef:o,labelFieldRef:t,nodePropsRef:r,renderOptionRef:i}=m(Se);return{labelField:t,showIcon:e,hasSubmenu:n,renderLabel:o,nodeProps:r,renderOption:i}},render(){var e;const{clsPrefix:n,hasSubmenu:o,showIcon:t,nodeProps:r,renderLabel:i,renderOption:l}=this,{rawNode:a}=this.tmNode,d=f("div",Object.assign({class:`${n}-dropdown-option`},null==r?void 0:r(a)),f("div",{class:`${n}-dropdown-option-body ${n}-dropdown-option-body--group`},f("div",{"data-dropdown-option":!0,class:[`${n}-dropdown-option-body__prefix`,t&&`${n}-dropdown-option-body__prefix--show-icon`]},P(a.icon)),f("div",{class:`${n}-dropdown-option-body__label`,"data-dropdown-option":!0},i?i(a):P(null!==(e=a.title)&&void 0!==e?e:a[this.labelField])),f("div",{class:[`${n}-dropdown-option-body__suffix`,o&&`${n}-dropdown-option-body__suffix--has-submenu`],"data-dropdown-option":!0})));return l?l({node:d,option:a}):d}}),_e=v({name:"NDropdownGroup",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0},parentKey:{type:[String,Number],default:null}},render(){const{tmNode:e,parentKey:n,clsPrefix:o}=this,{children:t}=e;return f(_,null,f(Oe,{clsPrefix:o,tmNode:e,key:e.key}),null==t?void 0:t.map((e=>{const{rawNode:t}=e;return!1===t.show?null:Pe(t)?f(ge,{clsPrefix:o,key:e.key}):e.isGroup?(O("dropdown","`group` node is not allowed to be put in `group` node."),null):f(Re,{clsPrefix:o,tmNode:e,parentKey:n,key:e.key})})))}}),Ie=v({name:"DropdownRenderOption",props:{tmNode:{type:Object,required:!0}},render(){const{rawNode:{render:e,props:n}}=this.tmNode;return f("div",n,[null==e?void 0:e()])}}),ze=v({name:"DropdownMenu",props:{scrollable:Boolean,showArrow:Boolean,arrowStyle:[String,Object],clsPrefix:{type:String,required:!0},tmNodes:{type:Array,default:()=>[]},parentKey:{type:[String,Number],default:null}},setup(e){const{renderIconRef:n,childrenFieldRef:o}=m(Se);w(ke,{showIconRef:y((()=>{const o=n.value;return e.tmNodes.some((e=>{var n;if(e.isGroup)return null===(n=e.children)||void 0===n?void 0:n.some((({rawNode:e})=>o?o(e):e.icon));const{rawNode:t}=e;return o?o(t):t.icon}))})),hasSubmenuRef:y((()=>{const{value:n}=o;return e.tmNodes.some((e=>{var o;if(e.isGroup)return null===(o=e.children)||void 0===o?void 0:o.some((({rawNode:e})=>Ne(e,n)));const{rawNode:t}=e;return Ne(t,n)}))}))});const t=r(null);return w(I,null),w(z,null),w(b,t),{bodyRef:t}},render(){const{parentKey:e,clsPrefix:n,scrollable:o}=this,t=this.tmNodes.map((t=>{const{rawNode:r}=t;return!1===r.show?null:function(e){return"render"===e.type}(r)?f(Ie,{tmNode:t,key:t.key}):Pe(r)?f(ge,{clsPrefix:n,key:t.key}):function(e){return"group"===e.type}(r)?f(_e,{clsPrefix:n,tmNode:t,parentKey:e,key:t.key}):f(Re,{clsPrefix:n,tmNode:t,parentKey:e,key:t.key,props:r.props,scrollable:o})}));return f("div",{class:[`${n}-dropdown-menu`,o&&`${n}-dropdown-menu--scrollable`],ref:"bodyRef"},o?f($,{contentClass:`${n}-dropdown-menu__content`},{default:()=>t}):t,this.showArrow?A({clsPrefix:n,arrowStyle:this.arrowStyle,arrowClass:void 0,arrowWrapperClass:void 0,arrowWrapperStyle:void 0}):null)}}),Ae=F("dropdown-menu","\n transform-origin: var(--v-transform-origin);\n background-color: var(--n-color);\n border-radius: var(--n-border-radius);\n box-shadow: var(--n-box-shadow);\n position: relative;\n transition:\n background-color .3s var(--n-bezier),\n box-shadow .3s var(--n-bezier);\n",[B(),F("dropdown-option","\n position: relative;\n ",[K("a","\n text-decoration: none;\n color: inherit;\n outline: none;\n ",[K("&::before",'\n content: "";\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n ')]),F("dropdown-option-body","\n display: flex;\n cursor: pointer;\n position: relative;\n height: var(--n-option-height);\n line-height: var(--n-option-height);\n font-size: var(--n-font-size);\n color: var(--n-option-text-color);\n transition: color .3s var(--n-bezier);\n ",[K("&::before",'\n content: "";\n position: absolute;\n top: 0;\n bottom: 0;\n left: 4px;\n right: 4px;\n transition: background-color .3s var(--n-bezier);\n border-radius: var(--n-border-radius);\n '),T("disabled",[D("pending","\n color: var(--n-option-text-color-hover);\n ",[j("prefix, suffix","\n color: var(--n-option-text-color-hover);\n "),K("&::before","background-color: var(--n-option-color-hover);")]),D("active","\n color: var(--n-option-text-color-active);\n ",[j("prefix, suffix","\n color: var(--n-option-text-color-active);\n "),K("&::before","background-color: var(--n-option-color-active);")]),D("child-active","\n color: var(--n-option-text-color-child-active);\n ",[j("prefix, suffix","\n color: var(--n-option-text-color-child-active);\n ")])]),D("disabled","\n cursor: not-allowed;\n opacity: var(--n-option-opacity-disabled);\n "),D("group","\n font-size: calc(var(--n-font-size) - 1px);\n color: var(--n-group-header-text-color);\n ",[j("prefix","\n width: calc(var(--n-option-prefix-width) / 2);\n ",[D("show-icon","\n width: calc(var(--n-option-icon-prefix-width) / 2);\n ")])]),j("prefix","\n width: var(--n-option-prefix-width);\n display: flex;\n justify-content: center;\n align-items: center;\n color: var(--n-prefix-color);\n transition: color .3s var(--n-bezier);\n z-index: 1;\n ",[D("show-icon","\n width: var(--n-option-icon-prefix-width);\n "),F("icon","\n font-size: var(--n-option-icon-size);\n ")]),j("label","\n white-space: nowrap;\n flex: 1;\n z-index: 1;\n "),j("suffix","\n box-sizing: border-box;\n flex-grow: 0;\n flex-shrink: 0;\n display: flex;\n justify-content: flex-end;\n align-items: center;\n min-width: var(--n-option-suffix-width);\n padding: 0 8px;\n transition: color .3s var(--n-bezier);\n color: var(--n-suffix-color);\n z-index: 1;\n ",[D("has-submenu","\n width: var(--n-option-icon-suffix-width);\n "),F("icon","\n font-size: var(--n-option-icon-size);\n ")]),F("dropdown-menu","pointer-events: all;")]),F("dropdown-offset-container","\n pointer-events: none;\n position: absolute;\n left: 0;\n right: 0;\n top: -4px;\n bottom: -4px;\n ")]),F("dropdown-divider","\n transition: background-color .3s var(--n-bezier);\n background-color: var(--n-divider-color);\n height: 1px;\n margin: 4px 0;\n "),F("dropdown-menu-wrapper","\n transform-origin: var(--v-transform-origin);\n width: fit-content;\n "),K(">",[F("scrollbar","\n height: inherit;\n max-height: inherit;\n ")]),T("scrollable","\n padding: var(--n-padding);\n "),D("scrollable",[j("content","\n padding: var(--n-padding);\n ")])]),$e={animated:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},size:{type:String,default:"medium"},inverted:Boolean,placement:{type:String,default:"bottom"},onSelect:[Function,Array],options:{type:Array,default:()=>[]},menuProps:Function,showArrow:Boolean,renderLabel:Function,renderIcon:Function,renderOption:Function,nodeProps:Function,labelField:{type:String,default:"label"},keyField:{type:String,default:"key"},childrenField:{type:String,default:"children"},value:[String,Number]},Fe=Object.keys(J),Be=v({name:"Dropdown",inheritAttrs:!1,props:Object.assign(Object.assign(Object.assign({},J),$e),q.props),setup(e){const n=r(!1),t=L(M(e,"show"),n),v=y((()=>{const{keyField:n,childrenField:t}=e;return o(e.options,{getKey:e=>e[n],getDisabled:e=>!0===e.disabled,getIgnored:e=>"divider"===e.type||"render"===e.type,getChildren:e=>e[t]})})),f=y((()=>v.value.treeNodes)),h=r(null),m=r(null),b=r(null),g=y((()=>{var e,n,o;return null!==(o=null!==(n=null!==(e=h.value)&&void 0!==e?e:m.value)&&void 0!==n?n:b.value)&&void 0!==o?o:null})),k=y((()=>v.value.getPath(g.value).keyPath)),S=y((()=>v.value.getPath(e.value).keyPath));!function(e={},n){const o=l({ctrl:!1,command:!1,win:!1,shift:!1,tab:!1}),{keydown:t,keyup:r}=e,v=e=>{switch(e.key){case"Control":o.ctrl=!0;break;case"Meta":o.command=!0,o.win=!0;break;case"Shift":o.shift=!0;break;case"Tab":o.tab=!0}void 0!==t&&Object.keys(t).forEach((n=>{if(n!==e.key)return;const o=t[n];if("function"==typeof o)o(e);else{const{stop:n=!1,prevent:t=!1}=o;n&&e.stopPropagation(),t&&e.preventDefault(),o.handler(e)}}))},f=e=>{switch(e.key){case"Control":o.ctrl=!1;break;case"Meta":o.command=!1,o.win=!1;break;case"Shift":o.shift=!1;break;case"Tab":o.tab=!1}void 0!==r&&Object.keys(r).forEach((n=>{if(n!==e.key)return;const o=r[n];if("function"==typeof o)o(e);else{const{stop:n=!1,prevent:t=!1}=o;n&&e.stopPropagation(),t&&e.preventDefault(),o.handler(e)}}))},h=()=>{(void 0===n||n.value)&&(p("keydown",document,v),p("keyup",document,f)),void 0!==n&&i(n,(e=>{e?(p("keydown",document,v),p("keyup",document,f)):(u("keydown",document,v),u("keyup",document,f))}))};a()?(d(h),s((()=>{(void 0===n||n.value)&&(u("keydown",document,v),u("keyup",document,f))}))):h(),c(o)}({keydown:{ArrowUp:{prevent:!0,handler:function(){z("up")}},ArrowRight:{prevent:!0,handler:function(){z("right")}},ArrowDown:{prevent:!0,handler:function(){z("down")}},ArrowLeft:{prevent:!0,handler:function(){z("left")}},Enter:{prevent:!0,handler:function(){const e=I();(null==e?void 0:e.isLeaf)&&t.value&&(R(e.key,e.rawNode),O(!1))}},Escape:function(){O(!1)}}},x((()=>e.keyboard&&t.value)));const{mergedClsPrefixRef:C,inlineThemeDisabled:N}=E(e),P=q("Dropdown","-dropdown",Ae,H,e,C);function R(n,o){const{onSelect:t}=e;t&&U(t,n,o)}function O(o){const{"onUpdate:show":t,onUpdateShow:r}=e;t&&U(t,o),r&&U(r,o),n.value=o}function _(){h.value=null,m.value=null,b.value=null}function I(){var e;const{value:n}=v,{value:o}=g;return n&&null!==o&&null!==(e=n.getNode(o))&&void 0!==e?e:null}function z(e){const{value:n}=g,{value:{getFirstAvailableNode:o}}=v;let t=null;if(null===n){const e=o();null!==e&&(t=e.key)}else{const n=I();if(n){let o;switch(e){case"down":o=n.getNext();break;case"up":o=n.getPrev();break;case"right":o=n.getChild();break;case"left":o=n.getParent()}o&&(t=o.key)}}null!==t&&(h.value=null,m.value=t)}w(Se,{labelFieldRef:M(e,"labelField"),childrenFieldRef:M(e,"childrenField"),renderLabelRef:M(e,"renderLabel"),renderIconRef:M(e,"renderIcon"),hoverKeyRef:h,keyboardKeyRef:m,lastToggledSubmenuKeyRef:b,pendingKeyPathRef:k,activeKeyPathRef:S,animatedRef:M(e,"animated"),mergedShowRef:t,nodePropsRef:M(e,"nodeProps"),renderOptionRef:M(e,"renderOption"),menuPropsRef:M(e,"menuProps"),doSelect:R,doUpdateShow:O}),i(t,(n=>{e.animated||n||_()}));const A=y((()=>{const{size:n,inverted:o}=e,{common:{cubicBezierEaseInOut:t},self:r}=P.value,{padding:i,dividerColor:l,borderRadius:a,optionOpacityDisabled:d,[V("optionIconSuffixWidth",n)]:s,[V("optionSuffixWidth",n)]:u,[V("optionIconPrefixWidth",n)]:c,[V("optionPrefixWidth",n)]:p,[V("fontSize",n)]:v,[V("optionHeight",n)]:f,[V("optionIconSize",n)]:h}=r,m={"--n-bezier":t,"--n-font-size":v,"--n-padding":i,"--n-border-radius":a,"--n-option-height":f,"--n-option-prefix-width":p,"--n-option-icon-prefix-width":c,"--n-option-suffix-width":u,"--n-option-icon-suffix-width":s,"--n-option-icon-size":h,"--n-divider-color":l,"--n-option-opacity-disabled":d};return o?(m["--n-color"]=r.colorInverted,m["--n-option-color-hover"]=r.optionColorHoverInverted,m["--n-option-color-active"]=r.optionColorActiveInverted,m["--n-option-text-color"]=r.optionTextColorInverted,m["--n-option-text-color-hover"]=r.optionTextColorHoverInverted,m["--n-option-text-color-active"]=r.optionTextColorActiveInverted,m["--n-option-text-color-child-active"]=r.optionTextColorChildActiveInverted,m["--n-prefix-color"]=r.prefixColorInverted,m["--n-suffix-color"]=r.suffixColorInverted,m["--n-group-header-text-color"]=r.groupHeaderTextColorInverted):(m["--n-color"]=r.color,m["--n-option-color-hover"]=r.optionColorHover,m["--n-option-color-active"]=r.optionColorActive,m["--n-option-text-color"]=r.optionTextColor,m["--n-option-text-color-hover"]=r.optionTextColorHover,m["--n-option-text-color-active"]=r.optionTextColorActive,m["--n-option-text-color-child-active"]=r.optionTextColorChildActive,m["--n-prefix-color"]=r.prefixColor,m["--n-suffix-color"]=r.suffixColor,m["--n-group-header-text-color"]=r.groupHeaderTextColor),m})),$=N?G("dropdown",y((()=>`${e.size[0]}${e.inverted?"i":""}`)),A,e):void 0;return{mergedClsPrefix:C,mergedTheme:P,tmNodes:f,mergedShow:t,handleAfterLeave:()=>{e.animated&&_()},doUpdateShow:O,cssVars:N?void 0:A,themeClass:null==$?void 0:$.themeClass,onRender:null==$?void 0:$.onRender}},render(){const{mergedTheme:e}=this,n={show:this.mergedShow,theme:e.peers.Popover,themeOverrides:e.peerOverrides.Popover,internalOnAfterLeave:this.handleAfterLeave,internalRenderBody:(e,n,o,t,r)=>{var i;const{mergedClsPrefix:l,menuProps:a}=this;null===(i=this.onRender)||void 0===i||i.call(this);const d=(null==a?void 0:a(void 0,this.tmNodes.map((e=>e.rawNode))))||{},s={ref:xe(n),class:[e,`${l}-dropdown`,this.themeClass],clsPrefix:l,tmNodes:this.tmNodes,style:[...o,this.cssVars],showArrow:this.showArrow,arrowStyle:this.arrowStyle,scrollable:this.scrollable,onMouseenter:t,onMouseleave:r};return f(ze,N(this.$attrs,s,d))},onUpdateShow:this.doUpdateShow,"onUpdate:show":void 0};return f(Q,Object.assign({},W(this.$props,Fe),n),{trigger:()=>{var e,n;return null===(n=(e=this.$slots).default)||void 0===n?void 0:n.call(e)}})}}),Ke={class:"dynamic-value-display"},Te={key:0,class:"d-label"},De=ie(v({__name:"DynamicValueDisplay",props:{text:{default:""},label:{},formatFn:{}},setup(e){const n=e,{text:o}=X(n),t=r("");return Y(o,(()=>{"function"==typeof n.formatFn?t.value=n.formatFn(o.value):t.value=o.value}),{debounce:300,immediate:!0}),(e,n)=>(Z(),ee("div",Ke,[ne(oe(te(t))+" ",1),e.label?(Z(),ee("span",Te,oe(e.label),1)):re("",!0)]))}}),[["__scopeId","data-v-dc5f2fcb"]]),je=["data-index"],Le={key:0,class:"index-wrap"},Me={key:1,class:"item-icon"},Ee=["src"],qe=["innerHTML"],He={key:3,class:"item-content"},Ue={key:4,class:"item-content"},Ve={key:5,class:"item-content"},Ge={key:6,class:"arrow-wrap"},We=[le("div",{class:"css-arrow right"},null,-1)],Qe=v({__name:"QOptionItem",props:{item:{},index:{default:0},curIndex:{default:0},itemCls:{default:""}},setup:e=>(e,n)=>{var o,r,i,l;return Z(),ee("div",{class:ue(["option-item",[{focus:e.curIndex===e.index,clickable:(null==(r=null==(o=e.item)?void 0:o.props)?void 0:r.onClick)||e.item.children&&e.item.children,disabled:e.item.disabled},e.itemCls,null==(i=e.item.props)?void 0:i.class]]),style:ce(null==(l=e.item.props)?void 0:l.style),"data-index":e.index},[e.index<9?(Z(),ee("div",Le,[le("span",null,oe(e.index+1),1)])):re("",!0),e.item.icon?(Z(),ee("div",Me,[le("img",{src:e.item.icon,alt:"icon"},null,8,Ee)])):re("",!0),e.item.html?(Z(),ee("div",{key:2,class:"item-content",innerHTML:e.item.html},null,8,qe)):e.item.render?(Z(),ee("div",He,[ae(t,{"render-fn":e.item.render},null,8,["render-fn"])])):e.item.dynamicProps?(Z(),ee("div",Ue,[ae(De,de(se(e.item.dynamicProps)),null,16)])):(Z(),ee("div",Ve,oe(e.item.label),1)),e.item.children&&e.item.children?(Z(),ee("div",Ge,We)):re("",!0)],14,je)}}),Je=v({name:"QuickOptions",components:{QOptionItem:Qe},props:{visible:{type:Boolean,default:!1},horizontal:{type:Boolean,default:!1},title:{type:String,default:""},options:{type:Array,default:()=>[]},isStatic:{type:Boolean,default:!1},autoFocus:{type:Boolean,default:!0},itemCls:{type:String,default:""}},emits:["onClose","update:visible","onBack","onEnter"],setup(e,{emit:n}){const{options:o,horizontal:t,isStatic:l,autoFocus:a}=X(e),d=pe(e,"visible",n),s=r();ve(s,(e=>{l.value||(d.value=!1)}));const u=()=>{const e=s.value.querySelector(`[data-index="${c.value}"]`);he((()=>{e&&e.scrollIntoView({behavior:"instant",block:"center"})}))},c=r(0),p=()=>{c.value--,c.value<0&&(c.value=b.value.length-1),u()},v=()=>{c.value++,c.value>b.value.length-1&&(c.value=0),u()},f=()=>{setTimeout((()=>{s.value.focus()}),100)};fe((()=>{l.value&&a.value&&f()})),i(d,(e=>{e?(c.value=0,f()):h.value=[]}));const h=r([]),m=r(null),b=y((()=>m.value?m.value.value:h.value.length?h.value[h.value.length-1]:o.value)),w=()=>{if(m.value)return m.value=null,void n("onBack");h.value.length?(h.value.pop(),n("onBack")):(d.value=!1,setTimeout((()=>{n("onClose")}),100)),c.value=0,u()},x=()=>{const e=b.value[c.value];g(e)},g=async(e,o)=>{var t,r;if(!e.disabled){if(null==(t=null==e?void 0:e.props)?void 0:t.onClick)e.props.onClick(e,o),d.value=!1;else if(e.children){let o=[];"function"==typeof e.children?o=await e.children():e.children.length&&(o=e.children),o.__v_isRef?m.value=o:h.value.push(o),c.value=0,n("onEnter")}(null==(r=null==e?void 0:e.props)?void 0:r.isBack)&&w()}};return{mVisible:d,quickRootRef:s,menuStack:h,computedSubList:m,curIndex:c,handleKeyPress:e=>{if(e.preventDefault(),"Escape"===e.key||"q"===e.key)w();else if("ArrowUp"===e.key)t.value?w():p();else if("ArrowDown"===e.key)t.value?x():v();else if("ArrowLeft"===e.key)t.value?p():w();else if("ArrowRight"===e.key)t.value?v():x();else if("Enter"===e.key)x();else if(" "===e.key)x();else if(e.keyCode>=49&&e.keyCode<=57){const n=Number(String.fromCharCode(e.keyCode));if(Number.isNaN(n))return;console.log(n);const o=b.value[n-1];o&&g(o)}},handleBack:w,mOptions:b,handleOptionClick:g,handleOptionContextmenu:async(e,n)=>{var o;(null==(o=null==e?void 0:e.props)?void 0:o.onContextmenu)&&(null==n||n.preventDefault(),e.props.onContextmenu(e,n))}}}}),Xe={key:0,class:"option-title"},Ye=le("div",{class:"index-wrap"},[le("div",{style:{transform:"scale(0.7)"}},[le("div",{class:"css-arrow left"})])],-1);const Ze=ie(Je,[["render",function(e,n,o,t,r,i){const l=Qe,a=Be;return e.mVisible||e.isStatic?(Z(),ee("div",{key:0,class:ue(["quick-options _scrollbar_mini",{_absolute:!e.isStatic,_s:e.isStatic,horizontal:e.horizontal,"vp-panel":!e.horizontal&&!e.isStatic}]),onKeydown:n[2]||(n[2]=we(((...n)=>e.handleKeyPress&&e.handleKeyPress(...n)),["stop"])),tabindex:"0",ref:"quickRootRef"},[e.title?(Z(),ee("div",Xe,[ne(oe(e.title)+" ",1),le("button",{class:"btn-no-style",onClick:n[0]||(n[0]=n=>e.mVisible=!1)},"×")])):re("",!0),e.menuStack.length||e.computedSubList?(Z(),ee("div",{key:1,class:"option-item vp-bg _back clickable",onClick:n[1]||(n[1]=(...n)=>e.handleBack&&e.handleBack(...n))},[Ye,ne(" Back (q) ")])):re("",!0),(Z(!0),ee(_,null,me(e.mOptions,((n,o)=>(Z(),ee(_,{key:o},[n.dropdown?(Z(),be(a,{key:0,options:n.dropdown,size:"small"},{default:ye((()=>[ae(l,{item:n,index:o,"cur-index":e.curIndex,"item-cls":e.itemCls,onClick:o=>e.handleOptionClick(n,o),onContextmenu:o=>e.handleOptionContextmenu(n,o)},null,8,["item","index","cur-index","item-cls","onClick","onContextmenu"])])),_:2},1032,["options"])):(Z(),be(l,{key:1,item:n,index:o,"cur-index":e.curIndex,"item-cls":e.itemCls,onClick:o=>e.handleOptionClick(n,o),onContextmenu:o=>e.handleOptionContextmenu(n,o)},null,8,["item","index","cur-index","item-cls","onClick","onContextmenu"]))],64)))),128))],34)):re("",!0)}]]);export{Ze as _};
