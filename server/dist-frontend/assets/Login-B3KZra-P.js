import{d as e,r as s,l as a,o as t,B as o,a as r,w as l,O as i,P as n,c as u,m as d,C as p,Q as m,x as c,y as b,R as v,j as y,S as f,f as w,v as g,b as _,g as k,k as h,T as x,U as q,V as I,p as j,q as L,_ as P}from"./index-Ch1CAwop.js";import{_ as S,A as U}from"./index.vue_vue_type_style_index_0_lang-DPtjKX-A.js";/* empty css                  *//* empty css                 *//* empty css                        */import"./index-qFWBhN92.js";const F=e({__name:"LoginForm",props:{showSubmit:{type:Boolean},disabled:{type:Boolean}},emits:["submit"],setup(e,{expose:l,emit:i}){const n=s(),u=s({username:"",password:""}),d={username:[{required:!0,message:"Username is required",trigger:["blur"]}],password:[{required:!0,message:"Password is required",trigger:["blur"]}]},p=()=>{n.value.submitForm()},m=a((()=>[{type:U.INPUT,key:"username",label:"Username",placeholder:" ",props:{onKeyup:e=>{"Enter"===e.key&&p()}}},{type:U.INPUT,key:"password",label:"Password",placeholder:" ",props:{type:"password",showPassword:!0,onKeyup:e=>{"Enter"===e.key&&p()}}}]));return l({submitForm:p}),(e,s)=>(t(),o(S,{ref_key:"formRef",ref:n,"form-schema":{model:r(u),rules:d,props:{labelPosition:"top"},formItems:m.value},"hide-actions":"",onOnSubmit:s[0]||(s[0]=s=>e.$emit("submit",r(u)))},null,8,["form-schema"]))}}),T=e=>(j("data-v-56383847"),e=e(),L(),e),B={class:"login-view"},C={key:0,class:"card-wrap flex-row-center-gap font-code"},O=T((()=>_("div",null,"请输入接口传输密钥(ck):",-1))),R=["disabled"],A={key:1,class:"card-wrap"},E={class:"login-actions"},K=[T((()=>_("span",{class:"mdi mdi-security-network"},null,-1)))],N=["disabled"],V=P(e({__name:"Login",setup(e){const a=c(),o=b(),j=s("");l(f,(e=>{j.value=e}),{immediate:!0});const L=s(!1),P=s(!1),S=async e=>{if(!P.value)try{P.value=!0;let{username:s,password:t}=e;const r=await x.userLogin(s,t),{access_token:l}=r;if(!l)return void window.$message.error("Invalid token!");localStorage.setItem(q.LS_KEY_AUTHORIZATION,l),a.query.redirect?await o.push({path:a.query.redirect}):await o.push({path:"/"})}catch(s){console.error(s)}finally{P.value=!1}},U=()=>{V.value.submitForm()},T=s(),V=s();return i((()=>{n((()=>{var e;null==(e=T.value)||e.focus()}))})),(e,s)=>{const a=I;return t(),u("div",B,[d(m,null,{default:p((()=>[d(v,{visible:"","show-close":!1},{titleBarLeft:p((()=>[y("Login")])),default:p((()=>[!r(f)||r(L)?(t(),u("div",C,[O,w(_("input",{type:"text",class:"vp-input","onUpdate:modelValue":s[0]||(s[0]=e=>k(j)?j.value=e:null),style:{width:"100%"},placeholder:"请输入接口密钥"},null,512),[[g,r(j)]]),_("button",{class:"vp-button primary",onClick:s[1]||(s[1]=e=>(f.value=j.value,void(L.value=!1))),disabled:!r(j)}," Submit ",8,R)])):(t(),u("div",A,[w(d(F,{ref_key:"loginFormRef",ref:V,onSubmit:S,disabled:r(P)},null,8,["disabled"]),[[a,r(P)]]),_("div",E,[_("button",{class:"vp-button",type:"button",onClick:s[2]||(s[2]=e=>L.value=!0)},K),_("button",{class:"vp-button btn-login",type:"button",onClick:U,disabled:r(P)}," Login"+h(r(P)?"ing...":""),9,N)])]))])),_:1})])),_:1})])}}}),[["__scopeId","data-v-56383847"]]);export{V as default};
