import{_ as e,o as a,c as t,n as i,h as s,aw as l,ax as n,ay as o,az as r,aA as d,O as c,aB as u,aC as p,d as m,R as v,al as y,l as h,D as f,m as b,C as g,b as k,aD as w,f as _,at as x,F as L,e as I,k as C,j as E,p as S,q as P,W as T,r as D,w as N,a as A,aE as B,ae as R,B as V,aF as M,am as O,aG as $,aH as F,aI as K,aJ as U,aK as j,aL as q,ah as H,v as Y,g as G,aM as W,aN as z,av as Q}from"./index-Ch1CAwop.js";/* empty css                 *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";import{F as J}from"./FileSelector-B2cmxcS2.js";import"./index.vue_vue_type_style_index_0_lang-B6do1Ahd.js";const X={name:"CoverDisplay",props:{src:{type:String,default:null},isRounded:{type:Boolean,default:!1},isRotating:{type:Boolean,default:!1},isShowIcon:{type:Boolean,default:!0}}},Z={class:"cover-display"},ee=["src"],ae={key:1,class:"cover-icon"};const te=e(X,[["render",function(e,l,n,o,r,d){return a(),t("div",Z,[n.src?(a(),t("img",{key:0,src:n.src,class:i({rounded:n.isRounded,rotating:n.isRotating})},null,10,ee)):n.isShowIcon?(a(),t("span",ae,"CC")):s("",!0)])}],["__scopeId","data-v-f0291941"]]);class ie{constructor(e,a){this.guid=n(),this.filename=e,this.basePath=a,this.type=o.test(e)?"music":"video"}get absPath(){return r(this.basePath+"/"+this.filename)}get titleDisplay(){return this.filename}}var se=(e=>(e[e.NONE=1]="NONE",e[e.LOOP_SEQUENCE=2]="LOOP_SEQUENCE",e[e.LOOP_REVERSE=3]="LOOP_REVERSE",e[e.LOOP_SINGLE=4]="LOOP_SINGLE",e[e.SHUFFLE=5]="SHUFFLE",e))(se||{});const le=[1,2,3,4,5],ne={1:{value:1,i18nKey:"msg.play-in-order",className:"mdi mdi-shuffle-disabled",icon:"➡️"},5:{value:5,i18nKey:"shuffle",className:"mdi mdi-shuffle",icon:"🔀"},2:{value:2,icon:"🔁",className:"mdi mdi-repeat",i18nKey:"msg.sequential-loop"},3:{value:3,icon:"🔁",className:"mdi mdi-repeat-variant reverse-x",i18nKey:"msg.reverse-loop"},4:{value:4,icon:"🔂",className:"mdi mdi-repeat-once",i18nKey:"msg.single-cycle"}},oe=l("musicSettings",{state:()=>({loopMode:2,audioVolume:100}),actions:{setAudioVolume(e){(e=Number(e))>100&&(e=100),e<0&&(e=0),this.audioVolume=e},volumeUp(e=5){const a=this.audioVolume+e;this.setAudioVolume(a)},volumeDown(e=5){const a=this.audioVolume-e;this.setAudioVolume(a)}},persist:{key:"ls_key_canos_media_settings"}}),re="ACTION_PLAY",de="ACTION_PAUSE",ce="ACTION_TOGGLE_PLAY",ue="ACTION_CHANGE_CURRENT_TIME",pe=(e="mediaStore")=>new(l(e,{state:()=>({mediaBus:d(),mediaItem:null,playingList:[],playingIndex:0,paused:!0,currentTime:0,duration:0,playbackRate:1,stopCountdown:null,isPlayEnded:!1,isLoadedAutoplay:!0}),getters:{isVideo(){return this.mediaItem&&"video"===this.mediaItem.type}},actions:{playFromList(e=[],a=0){const t=e[a];t?(this.playingList=e,this.playingIndex=a,this.mediaItem=t,this.isLoadedAutoplay=!0):window.$message.error(`index=${a} not found`)},playPrev(){let e=this.playingIndex-1;e<0&&(e=this.playingList.length-1),this.playByIndex(e)},playShuffle(){this.playByIndex(function(e,a){const t=e.reduce(((e,t,i)=>(i!==a&&e.push(i),e)),[]);return t[p(0,t.length-1)]}(this.playingList,this.playingIndex))},playNext(){const e=oe();if(e.loopMode===se.SHUFFLE)return void this.playShuffle();let a=this.playingIndex+1;if(a>this.playingList.length-1){if(e.loopMode!==se.LOOP_SEQUENCE)return;a=0}this.playByIndex(a)},handlePlayEnded(){const e=oe();this.isPlayEnded=!0,e.loopMode!==se.LOOP_SINGLE?e.loopMode!==se.LOOP_REVERSE?e.loopMode!==se.SHUFFLE?this.playNext():this.playShuffle():this.playPrev():this.mediaBus.emit(re)},playByIndex(e){this.mediaItem=this.playingList[e],this.playingIndex=e,console.log("[playByIndex]",e,this.mediaItem),setTimeout((()=>{this.isPlayEnded?(this.mediaBus.emit(re),this.isPlayEnded=!1):this.paused&&this.mediaBus.emit(re)}),100)},reset(){this.mediaBus.emit(de),this.mediaItem=null,this.playingList=[]}}})),me=(e,a,t)=>{c((()=>{e.on(a,t)})),u((()=>{e.off(a,t)}))},ve={LYRIC:"LYRIC",METADATA:"METADATA"},ye=m({name:"MusicDetail",components:{ViewPortWindow:v,CoverDisplay:te},data(){return{currentDetailTab:ve.LYRIC,DetailTabEnum:ve,detailTabList:[{label:this.$t("lyric"),value:ve.LYRIC},{label:this.$t("metadata"),value:ve.METADATA}],isShowDetail:!1,isShowLyricSearch:!1,isLyricLock:!1,lyricObj:null,isShowCountdownConfig:!1}},setup(){const e=y("storeId"),a=pe(e.value);return{mediaStore:a,mediaItem:h((()=>a.mediaItem))}}}),he=e=>(S("data-v-fb62aa01"),e=e(),P(),e),fe={key:0,class:"music-detail"},be={class:"cover-wrap"},ge={class:"detail-content"},ke={class:"tab-wrap"},we=["onClick"],_e={class:"lyric-content"},xe={class:"lyric-lock"},Le=["title"],Ie=[he((()=>k("i",{class:"mdi mdi-search-web"},null,-1)))],Ce=["title"],Ee=["value","placeholder"],Se={class:"below-wrap"},Pe={class:"title"},Te={class:"subtitle"},De={class:"subtitle"},Ne=he((()=>k("div",{class:"actions-wrap"},null,-1)));const Ae=e(ye,[["render",function(e,l,n,o,r,d){const c=f("CoverDisplay"),u=f("AutoRatioBox"),p=f("ViewPortWindow");return e.mediaItem&&!e.mediaStore.isVideo?(a(),t("div",fe,[b(u,{class:"cover-wrap-box"},{default:g((()=>[k("div",be,[b(c,{class:"big-cover",src:e.mediaItem.cover,"is-rotating":!1,"is-rounded":!1,"is-show-icon":!1,onClick:l[0]||(l[0]=a=>e.isShowDetail=!0)},null,8,["src"]),b(w,{name:"fade"},{default:g((()=>[_(k("div",ge,[k("div",ke,[(a(!0),t(L,null,I(e.detailTabList,(s=>(a(),t("button",{key:s.value,class:i([{active:e.currentDetailTab===s.value},"btn-no-style"]),onClick:a=>e.currentDetailTab=s.value},C(s.label),11,we)))),128))]),_(k("div",_e,[k("div",xe,[k("button",{class:"btn-no-style",title:e.$t("search-lyric"),onClick:l[1]||(l[1]=a=>e.isShowLyricSearch=!0)},Ie,8,Le),k("button",{class:"btn-no-style",title:e.$t("lock-lyric"),onClick:l[2]||(l[2]=a=>e.isLyricLock=!e.isLyricLock)},[k("i",{class:i(["mdi",[e.isLyricLock?"mdi-lock":"mdi-lock-open"]])},null,2)],8,Ce)]),k("div",{class:"lrc-main no-lyric",onClick:l[3]||(l[3]=a=>e.isShowDetail=!1)},C(e.$t("msg.no-lyric"))+" TBD ",1)],512),[[x,e.currentDetailTab===e.DetailTabEnum.LYRIC]]),_(k("textarea",{class:"metadata",cols:"30",rows:"15",readonly:"",value:JSON.stringify(e.mediaItem,null,2),placeholder:e.$t("msg.no-data")},null,8,Ee),[[x,e.currentDetailTab===e.DetailTabEnum.METADATA]])],512),[[x,e.isShowDetail]])])),_:1})])])),_:1}),k("div",Se,[k("div",{class:i(["titles-wrap",{opacity:e.isShowDetail}]),onClick:l[4]||(l[4]=a=>e.isShowDetail=!e.isShowDetail)},[k("div",Pe,C(e.mediaItem.titleDisplay),1),k("div",Te,C(e.mediaItem.artisDisplay),1),k("div",De,C(e.mediaItem.album),1)],2),Ne]),b(p,{visible:e.isShowLyricSearch,"onUpdate:visible":l[5]||(l[5]=a=>e.isShowLyricSearch=a)},{titleBarLeft:g((()=>[E(C(e.$t("playback-speed"))+" TBD ",1)])),_:1},8,["visible"])])):s("",!0)}],["__scopeId","data-v-fb62aa01"]]),Be={class:"player-core"},Re=["src"],Ve=["src"],Me=e(m({__name:"PlayerCore",setup(e){const i=y("storeId"),s=pe(i.value),{t:l}=T(),n=D(),o=oe(),r=D(),d=()=>{n.value.play()},c=()=>{n.value.pause()},p=()=>{s.playPrev()},m=()=>{s.playNext()},v=e=>{n.value&&(n.value.volume=e/100)},h=(e=1)=>{if(n.value)try{n.value.playbackRate=e}catch(a){window.$message.error(a.message)}};return N((()=>o.audioVolume),v),N((()=>s.playbackRate),h),N((()=>s.mediaItem),(async e=>{if(!e)return void(r.value=void 0);r.value=await B.getStreamShareLink([e.absPath]);const a=s.playbackRate;n.value.load(),setTimeout((()=>{h(a)}))}),{immediate:!0}),N((()=>s.isVideo),(()=>{setTimeout((()=>{var e;v(o.audioVolume),h(s.playbackRate),e=n.value,"mediaSession"in navigator&&(navigator.mediaSession.setActionHandler("play",d),navigator.mediaSession.setActionHandler("pause",c),navigator.mediaSession.setActionHandler("previoustrack",p),navigator.mediaSession.setActionHandler("nexttrack",m)),e.addEventListener("play",(()=>{s.paused=!1,s.isLoadedAutoplay=!0})),e.addEventListener("pause",(()=>{s.paused=!0,s.isLoadedAutoplay=!1})),e.addEventListener("ended",(()=>{s.handlePlayEnded()})),e.addEventListener("volumechange",(()=>{o.setAudioVolume(100*e.volume)})),e.addEventListener("ratechange",(function(){s.playbackRate=e.playbackRate})),e.addEventListener("canplay",(e=>{s.duration=e.target.duration,s.isLoadedAutoplay&&d()})),e.addEventListener("timeupdate",(e=>{s.currentTime=e.target.currentTime})),e.addEventListener("error",(e=>{console.error(e),window.$message.error(l("msg.load-fail-or-no-supported-source"))}))}))}),{immediate:!0}),me(s.mediaBus,ce,(()=>{n.value&&n.value.src&&(n.value.paused?d():c())})),me(s.mediaBus,re,d),me(s.mediaBus,de,c),me(s.mediaBus,ue,(e=>{n.value&&(n.value.currentTime=e)})),u((()=>{})),(e,i)=>(a(),t("div",Be,[A(s).isVideo?(a(),t("video",{key:0,ref_key:"avRef",ref:n,src:A(r),controls:""},null,8,Re)):(a(),t("audio",{key:1,ref_key:"avRef",ref:n,src:A(r),controls:""},null,8,Ve))]))}}),[["__scopeId","data-v-f57e8965"]]),Oe={class:"btn-no-style btn-cover flex items-center justify-center"},$e=e(m({__name:"CoverMini",props:{src:{},isVideo:{type:Boolean}},setup:e=>(e,s)=>(a(),t("button",Oe,[R(e.$slots,"default",{},void 0,!0),e.src?(a(),V(te,{key:0,src:e.src},null,8,["src"])):(a(),t("i",{key:1,class:i(["icon-wrap mdi",[e.isVideo?"mdi-video-outline":"mdi-music-note"]])},null,2))]))}),[["__scopeId","data-v-cf8c8ec9"]]),Fe={name:"TkSeekbar",props:{min:{type:[Number,String],default:0},max:{type:[Number,String],default:100},value:{type:[Number,String],default:100},vertical:{type:Boolean,default:!1},wheel:{type:Boolean,default:!1}},emits:["input","focus","blur","change"],computed:{progress(){return(this.value/this.max*100).toFixed(1)}},methods:{handleInput(e){this.$emit("input",e.target.value)},handleFocus(e){this.$emit("focus",e)},handleBlur(e){this.$emit("blur",e)},handleChange(e){this.$emit("change",e.target.value)},handleWheel(e){if(this.wheel){e.preventDefault();const a=this.$refs.seekBar,t=e.deltaY||0,i=Math.abs(t)/64;t>0?a.value=this.value-i:t<0&&(a.value=this.value+i),this.$emit("input",a.value)}}}},Ke=["min","max","value"];const Ue=e(Fe,[["render",function(e,l,n,o,r,d){return a(),t("div",{class:i(["tk-seekbar",{vertical:n.vertical}])},[n.vertical?s("",!0):(a(),t("div",{key:0,class:"seekbar-fill",style:M("width:"+d.progress+"%")},null,4)),k("input",O({ref:"seekBar",type:"range",min:n.min,max:n.max,value:n.value,class:"common-seekbar seekbar-input"},e.$attrs,{onInput:l[0]||(l[0]=(...e)=>d.handleInput&&d.handleInput(...e)),onFocus:l[1]||(l[1]=(...e)=>d.handleFocus&&d.handleFocus(...e)),onBlur:l[2]||(l[2]=(...e)=>d.handleBlur&&d.handleBlur(...e)),onChange:l[3]||(l[3]=(...e)=>d.handleChange&&d.handleChange(...e)),onWheel:l[4]||(l[4]=(...e)=>d.handleWheel&&d.handleWheel(...e))}),null,16,Ke)],2)}],["__scopeId","data-v-b6bc18a5"]]);var je,qe={exports:{}};je=qe,function(e,a,t){if(e){for(var i,s={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},l={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},n={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},o={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},r=1;r<20;++r)s[111+r]="f"+r;for(r=0;r<=9;++r)s[r+96]=r.toString();y.prototype.bind=function(e,a,t){var i=this;return e=e instanceof Array?e:[e],i._bindMultiple.call(i,e,a,t),i},y.prototype.unbind=function(e,a){return this.bind.call(this,e,(function(){}),a)},y.prototype.trigger=function(e,a){var t=this;return t._directMap[e+":"+a]&&t._directMap[e+":"+a]({},e),t},y.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},y.prototype.stopCallback=function(e,a){if((" "+a.className+" ").indexOf(" mousetrap ")>-1)return!1;if(v(a,this.target))return!1;if("composedPath"in e&&"function"==typeof e.composedPath){var t=e.composedPath()[0];t!==e.target&&(a=t)}return"INPUT"==a.tagName||"SELECT"==a.tagName||"TEXTAREA"==a.tagName||a.isContentEditable},y.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},y.addKeycodes=function(e){for(var a in e)e.hasOwnProperty(a)&&(s[a]=e[a]);i=null},y.init=function(){var e=y(a);for(var t in e)"_"!==t.charAt(0)&&(y[t]=function(a){return function(){return e[a].apply(e,arguments)}}(t))},y.init(),e.Mousetrap=y,je.exports&&(je.exports=y)}function d(e,a,t){e.addEventListener?e.addEventListener(a,t,!1):e.attachEvent("on"+a,t)}function c(e){if("keypress"==e.type){var a=String.fromCharCode(e.which);return e.shiftKey||(a=a.toLowerCase()),a}return s[e.which]?s[e.which]:l[e.which]?l[e.which]:String.fromCharCode(e.which).toLowerCase()}function u(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function p(e,a,t){return t||(t=function(){if(!i)for(var e in i={},s)e>95&&e<112||s.hasOwnProperty(e)&&(i[s[e]]=e);return i}()[e]?"keydown":"keypress"),"keypress"==t&&a.length&&(t="keydown"),t}function m(e,a){var t,i,s,l=[];for(t=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),s=0;s<t.length;++s)i=t[s],o[i]&&(i=o[i]),a&&"keypress"!=a&&n[i]&&(i=n[i],l.push("shift")),u(i)&&l.push(i);return{key:i,modifiers:l,action:a=p(i,l,a)}}function v(e,t){return null!==e&&e!==a&&(e===t||v(e.parentNode,t))}function y(e){var t=this;if(e=e||a,!(t instanceof y))return new y(e);t.target=e,t._callbacks={},t._directMap={};var i,s={},l=!1,n=!1,o=!1;function r(e){e=e||{};var a,t=!1;for(a in s)e[a]?t=!0:s[a]=0;t||(o=!1)}function p(e,a,i,l,n,o){var r,d,c,p,m=[],v=i.type;if(!t._callbacks[e])return[];for("keyup"==v&&u(e)&&(a=[e]),r=0;r<t._callbacks[e].length;++r)if(d=t._callbacks[e][r],(l||!d.seq||s[d.seq]==d.level)&&v==d.action&&("keypress"==v&&!i.metaKey&&!i.ctrlKey||(c=a,p=d.modifiers,c.sort().join(",")===p.sort().join(",")))){var y=!l&&d.combo==n,h=l&&d.seq==l&&d.level==o;(y||h)&&t._callbacks[e].splice(r,1),m.push(d)}return m}function v(e,a,i,s){t.stopCallback(a,a.target||a.srcElement,i,s)||!1===e(a,i)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(a),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(a))}function h(e){"number"!=typeof e.which&&(e.which=e.keyCode);var a=c(e);a&&("keyup"!=e.type||l!==a?t.handleKey(a,function(e){var a=[];return e.shiftKey&&a.push("shift"),e.altKey&&a.push("alt"),e.ctrlKey&&a.push("ctrl"),e.metaKey&&a.push("meta"),a}(e),e):l=!1)}function f(e,a,t,n){function d(a){return function(){o=a,++s[e],clearTimeout(i),i=setTimeout(r,1e3)}}function u(a){v(t,a,e),"keyup"!==n&&(l=c(a)),setTimeout(r,10)}s[e]=0;for(var p=0;p<a.length;++p){var y=p+1===a.length?u:d(n||m(a[p+1]).action);b(a[p],y,n,e,p)}}function b(e,a,i,s,l){t._directMap[e+":"+i]=a;var n,o=(e=e.replace(/\s+/g," ")).split(" ");o.length>1?f(e,o,a,i):(n=m(e,i),t._callbacks[n.key]=t._callbacks[n.key]||[],p(n.key,n.modifiers,{type:n.action},s,e,l),t._callbacks[n.key][s?"unshift":"push"]({callback:a,modifiers:n.modifiers,action:n.action,seq:s,level:l,combo:e}))}t._handleKey=function(e,a,t){var i,s=p(e,a,t),l={},d=0,c=!1;for(i=0;i<s.length;++i)s[i].seq&&(d=Math.max(d,s[i].level));for(i=0;i<s.length;++i)if(s[i].seq){if(s[i].level!=d)continue;c=!0,l[s[i].seq]=1,v(s[i].callback,t,s[i].combo,s[i].seq)}else c||v(s[i].callback,t,s[i].combo);var m="keypress"==t.type&&n;t.type!=o||u(e)||m||r(l),n=c&&"keydown"==t.type},t._bindMultiple=function(e,a,t){for(var i=0;i<e.length;++i)b(e[i],a,t)},d(e,"keypress",h),d(e,"keydown",h),d(e,"keyup",h)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null);const He=$(qe.exports),Ye=e=>(S("data-v-0bda47b0"),e=e(),P(),e),Ge={key:0,class:"actionbar-wrapper"},We={class:"progressbar"},ze={class:"time text-overflow"},Qe={class:"time text-overflow"},Je={class:"actionbar"},Xe={class:"title text-overflow"},Ze={class:"buttons-scroll"},ea=["disabled","title"],aa=[Ye((()=>k("span",{class:"mdi mdi-skip-previous"},null,-1)))],ta=["disabled","title"],ia={key:0,class:"mdi mdi-play"},sa={key:1,class:"mdi mdi-pause"},la=["disabled","title"],na=[Ye((()=>k("span",{class:"mdi mdi-skip-next"},null,-1)))],oa=["title"],ra={class:"flex-row-center-gap"},da=["title"],ca={key:1},ua=["title"],pa={key:0,class:"mdi mdi-volume-high"},ma={key:1,class:"mdi mdi-volume-variant-off"},va={style:{display:"flex","align-items":"center","flex-direction":"column"}},ya={style:{"font-size":"12px"}},ha=e(m({__name:"MusicControl",emits:["onCoverClick","onTitleClick"],setup(e,{emit:l}){const n=y("storeId"),o=pe(n.value),r=["left","pageup","k","l"],d=["right","pagedown","h","j"],{t:p}=T(),m=oe(),v=D(0),f=D(!1),w=D(!1),L=F(),I=e=>{e.preventDefault(),o.mediaBus.emit(ce)},E=()=>{o.playPrev()},S=()=>{o.playNext()},P=e=>{e.preventDefault(),m.volumeUp()},B=e=>{e.preventDefault(),m.volumeDown()},R=()=>{let e=le.findIndex((e=>e===m.loopMode));++e,e>le.length-1&&(e=0),le[e]&&(m.loopMode=le[e],window.$message.info(p(O.value.i18nKey)))},V=e=>{f.value=!0,v.value=Number(e)},M=e=>{e=Number(e),o.mediaBus.emit(ue,e),f.value=!1},O=h((()=>ne[m.loopMode]));c((()=>{const e=new He;e.bind("space",I),e.bind(r,E),e.bind(d,S),e.bind("ctrl+x",R),e.bind("up",P),e.bind("down",B),L.value=e})),u((()=>{L.value&&L.value.reset()})),N((()=>o.currentTime),(e=>{f.value||(v.value=e)}));const $=h((()=>o.mediaItem)),H=()=>{o.mediaBus.emit(ue,o.currentTime+=5)},Y=()=>{o.mediaBus.emit(ue,o.currentTime-=5)};return(e,l)=>{const n=j,r=q;return A($)?(a(),t("div",Ge,[k("div",We,[k("span",ze,C(A(K)(A(v))),1),b(Ue,{max:A(o).duration,value:A(v),onInput:V,onChange:M},null,8,["max","value"]),k("span",Qe,C(A(K)(A(o).duration)),1)]),k("div",Je,[b($e,{src:A($).cover,"is-video":"video"===A($).type,onClick:l[0]||(l[0]=a=>e.$emit("onCoverClick"))},null,8,["src","is-video"]),k("button",{class:"btn-song-info btn-no-style",onClick:l[1]||(l[1]=a=>e.$emit("onTitleClick"))},[k("span",Xe,C(A($).titleDisplay),1),_(k("span",{class:"artist text-overflow"},C(A($).artist),513),[[x,A($).artist]]),_(k("span",{class:"album text-overflow"},C(A($).album),513),[[x,A($).album]])]),k("div",Ze,[k("button",{disabled:A(w),class:"btn-action btn-no-style icon-wrap",title:A(p)("previous"),onClick:E,onContextmenu:U(Y,["prevent"])},aa,40,ea),k("button",{disabled:A(w),class:"btn-action btn-no-style icon-wrap",title:A(o).paused?A(p)("play"):A(p)("pause"),onClick:I},[A(o).paused?(a(),t("span",ia)):(a(),t("span",sa))],8,ta),k("button",{disabled:A(w),class:"btn-action btn-no-style icon-wrap",title:A(p)("next"),onClick:S,onContextmenu:U(H,["prevent"])},na,40,la),b(r,{placement:"top",trigger:"hover"},{reference:g((()=>[k("button",{class:"btn-action btn-no-style icon-wrap",title:A(p)("playback-speed")},C(A(o).playbackRate)+"x ",9,oa)])),default:g((()=>[k("div",ra,[k("button",{class:"vp-button",onClick:l[2]||(l[2]=e=>A(o).playbackRate=Number(1))},"重置"),b(n,{style:{width:"150px"},modelValue:A(o).playbackRate,"onUpdate:modelValue":l[3]||(l[3]=e=>A(o).playbackRate=e),max:2,min:.1,step:.1},null,8,["modelValue"])])])),_:1}),A(O)?(a(),t("button",{key:0,class:"btn-action btn-no-style icon-wrap",title:A(p)(A(O).i18nKey),onClick:R},[A(O).icon||A(O).className?(a(),t("span",{key:0,class:i(["material-icons",A(O).className])},null,2)):(a(),t("span",ca,C(A(p)(A(O).i18nKey)),1))],8,da)):s("",!0),b(r,{placement:"top",trigger:"hover"},{reference:g((()=>[k("button",{class:"btn-action btn-no-style icon-wrap",title:A(p)("volume")},[A(m).audioVolume>0?(a(),t("span",pa)):(a(),t("span",ma))],8,ua)])),default:g((()=>[k("div",va,[b(n,{style:{width:"100px"},max:100,tooltip:!1,modelValue:A(m).audioVolume,"onUpdate:modelValue":l[4]||(l[4]=e=>A(m).audioVolume=e)},null,8,["modelValue"]),k("span",ya,C(A(m).audioVolume),1)])])),_:1})])])])):s("",!0)}}}),[["__scopeId","data-v-0bda47b0"]]),fa={class:"playlist-item"},ba={class:"item-left"},ga={key:0,class:"status-icon"},ka={key:0,class:"mdi mdi-play"},wa={key:1,class:"mdi mdi-pause"},_a={class:"item-main"},xa={class:"item-title"},La={class:"item-subtitle"},Ia=(e=>(S("data-v-70f2ea0e"),e=e(),P(),e))((()=>k("div",{class:"item-right"},null,-1))),Ca=e(m({__name:"PlaylistItem",props:{item:{}},setup(e){const i=e,l=y("storeId"),n=pe(l.value),{item:o}=H(i),r=h((()=>{var e;return o.value.guid===(null==(e=n.mediaItem)?void 0:e.guid)}));return(e,i)=>(a(),t("div",fa,[k("div",ba,[A(r)?(a(),t("div",ga,[A(n).paused?(a(),t("span",wa)):(a(),t("span",ka))])):s("",!0),b($e,{src:A(o).cover,"force-show-icon":"","is-video":"video"===A(o).type},null,8,["src","is-video"])]),k("div",_a,[k("div",xa,C(A(o).titleDisplay),1),k("div",La,C(A(o).artistsAlbumDisplay),1)]),Ia]))}}),[["__scopeId","data-v-70f2ea0e"]]),Ea={class:"music-play-list"},Sa={class:"vp-bg playlist-action-bar"},Pa=["placeholder"],Ta={class:"number-display"},Da={key:0,class:"flex-row-center-gap media-open-actions"},Na={key:1,class:"music-list"},Aa=e(m({__name:"index",setup(e){const i=y("storeId"),s=pe(i.value),l=D(""),n=h((()=>{if(!l.value)return s.playingList;const e=new RegExp(l.value,"ig");return s.playingList.filter((a=>(a.titleDisplay,e.test(a.titleDisplay)||e.test(a.artistsAlbumDisplay))))})),o=e=>{const a=e.items,t=e.basePath;if(console.log("[handleSelect]",e),!a)return;const i=a.map((e=>new ie(e.name,t))).filter((e=>z(e.filename)));s.playFromList(i,0)};return(e,i)=>(a(),t("div",Ea,[k("div",Sa,[_(k("input",{class:"vp-input",placeholder:e.$t("filter-by-name"),"onUpdate:modelValue":i[0]||(i[0]=e=>G(l)?l.value=e:null)},null,8,Pa),[[Y,A(l)]]),k("span",Ta,C(A(s).playingIndex+1)+" / "+C(A(s).playingList.length),1),b(W,{options:[{label:"Reset",props:{onClick(){A(s).reset()}}}]},null,8,["options"])]),A(s).playingList.length?(a(),t("div",Na,[(a(!0),t(L,null,I(A(n),(e=>(a(),V(Ca,{key:e.guid,item:e,onClick:a=>(e=>{const a=s.playingList.findIndex((a=>a.guid===e.guid));-1!==a?a!==s.playingIndex?s.playByIndex(a):s.mediaBus.emit(ce):console.error("idx not found!")})(e)},null,8,["item","onClick"])))),128))])):(a(),t("div",Da,[b(J,{"select-file-mode":"file",multiple:"",onHandleSelect:o})]))]))}}),[["__scopeId","data-v-27ddadea"]]),Ba={class:"foldable-sidebar-layout vp-panel"},Ra=[(e=>(S("data-v-3bde0cf8"),e=e(),P(),e))((()=>k("svg",{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},[k("g",{fill:"none"},[k("path",{d:"M10.354 3.146a.5.5 0 0 1 0 .708L6.207 8l4.147 4.146a.5.5 0 0 1-.708.708l-4.5-4.5a.5.5 0 0 1 0-.708l4.5-4.5a.5.5 0 0 1 .708 0z",fill:"currentColor"})])],-1)))],Va={class:"layout-content"},Ma=e(m({__name:"FoldableSidebarLayout",setup(e){const s=D(!0);return(e,l)=>(a(),t("div",Ba,[k("div",{class:i(["layout-sidebar",{_expand:A(s)}])},[R(e.$slots,"sidebar",{},void 0,!0),k("button",{class:"btn-toggle-expand btn-no-style",onClick:l[0]||(l[0]=e=>s.value=!A(s))},Ra)],2),k("div",Va,[R(e.$slots,"default",{},void 0,!0)])]))}}),[["__scopeId","data-v-3bde0cf8"]]),Oa={class:"media-player-wrap"},$a={class:"music-above"},Fa={class:"media-detail"},Ka={class:"music-below"},Ua=e(m({name:"MediaPlayer",props:{appParams:{}},setup(e){const i=e,s=D(`mediaStore_${n()}`);Q("storeId",s);const l=pe(s.value);return N((()=>i.appParams),(()=>{if(console.log(i.appParams),!i.appParams)return;const{item:e,list:a,basePath:t}=i.appParams,s=a.map((e=>new ie(e.name,t))).filter((e=>z(e.filename))),n=s.findIndex((a=>a.filename===e.name));l.playFromList(s,n)}),{immediate:!0}),(e,i)=>(a(),t("div",Oa,[k("div",$a,[b(Ma,null,{sidebar:g((()=>[b(Aa)])),default:g((()=>[k("div",Fa,[_(b(Me,null,null,512),[[x,A(l).isVideo]]),b(Ae)])])),_:1})]),k("div",Ka,[b(ha)])]))}}),[["__scopeId","data-v-199b0e09"]]);export{Ua as default};
